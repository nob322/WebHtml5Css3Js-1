{"version":3,"sources":["webpack://@amcharts/amcharts5/./src/.internal/charts/venn/VennDefaultTheme.ts","webpack://@amcharts/amcharts5/./dist/es2015/.internal/charts/venn/vennjs/fmin/blas1.js","webpack://@amcharts/amcharts5/./dist/es2015/.internal/charts/venn/vennjs/fmin/nelderMead.js","webpack://@amcharts/amcharts5/./dist/es2015/.internal/charts/venn/vennjs/fmin/linesearch.js","webpack://@amcharts/amcharts5/./dist/es2015/.internal/charts/venn/vennjs/fmin/conjugateGradient.js","webpack://@amcharts/amcharts5/./dist/es2015/.internal/charts/venn/vennjs/circleintersection.js","webpack://@amcharts/amcharts5/./dist/es2015/.internal/charts/venn/vennjs/layout.js","webpack://@amcharts/amcharts5/./dist/es2015/.internal/charts/venn/vennjs/fmin/bisect.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selector.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selectorAll.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/matcher.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/sparse.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/enter.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/data.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/sort.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/namespaces.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/namespace.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/attr.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/window.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/style.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/property.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/classed.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/text.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/html.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/raise.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/lower.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/creator.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/insert.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/remove.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/clone.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/on.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/dispatch.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/index.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/select.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/selectAll.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/filter.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/constant.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/exit.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/join.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/merge.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/order.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/call.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/nodes.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/node.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/size.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/empty.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/each.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/append.js","webpack://@amcharts/amcharts5/./node_modules/d3-selection/src/selection/datum.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/node_modules/d3-dispatch/src/dispatch.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/node_modules/d3-timer/src/timer.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/node_modules/d3-timer/src/timeout.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/transition/schedule.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/node_modules/d3-interpolate/src/number.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/node_modules/d3-interpolate/src/transform/decompose.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/node_modules/d3-interpolate/src/transform/parse.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/node_modules/d3-interpolate/src/transform/index.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/transition/tween.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/node_modules/d3-color/src/define.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/node_modules/d3-color/src/color.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/node_modules/d3-interpolate/src/basis.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/node_modules/d3-interpolate/src/constant.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/node_modules/d3-interpolate/src/color.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/node_modules/d3-interpolate/src/rgb.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/node_modules/d3-interpolate/src/basisClosed.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/node_modules/d3-interpolate/src/string.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/transition/interpolate.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/transition/attr.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/transition/attrTween.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/transition/delay.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/transition/duration.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/transition/ease.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/transition/on.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/transition/selection.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/transition/style.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/transition/styleTween.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/transition/textTween.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/transition/index.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/transition/select.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/transition/selectAll.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/transition/filter.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/transition/merge.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/transition/transition.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/transition/text.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/transition/remove.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/transition/end.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/selection/transition.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/node_modules/d3-ease/src/cubic.js","webpack://@amcharts/amcharts5/./dist/es2015/.internal/charts/venn/vennjs/diagram.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/selection/index.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/selection/interrupt.js","webpack://@amcharts/amcharts5/./node_modules/d3-transition/src/interrupt.js","webpack://@amcharts/amcharts5/./src/.internal/charts/venn/Venn.ts","webpack://@amcharts/amcharts5/./tmp/webpack/venn.js"],"names":["setupDefaultRules","r","this","rule","bind","setAll","legendLabelText","legendValueText","colors","ColorSet","_root","width","height","text","populateText","centerX","centerY","Theme","zeros","x","Array","i","zerosM","y","map","dot","a","b","ret","length","norm2","Math","sqrt","scale","value","c","weightedSum","w1","v1","w2","v2","j","nelderMead","f","x0","parameters","maxDiff","maxIterations","nonZeroDelta","zeroDelta","minErrorDelta","minTolerance","rho","undefined","chi","psi","sigma","N","simplex","fx","id","point","slice","updateSimplex","sortOrder","centroid","reflected","contracted","expanded","iteration","sort","history","sortedSimplex","state","push","max","abs","worst","shouldReduce","wolfeLineSearch","pk","current","next","c1","c2","phi0","phiPrime0","fxprime","phi","phi_old","phiPrime","a0","zoom","a_lo","a_high","phi_lo","conjugateGradient","initial","params","temp","yk","alpha","delta_k","intersectionArea","circles","stats","intersectionPoints","intersect","circleCircleIntersection","k","p","parentIndex","getIntersectionPoints","innerPoints","filter","distance","radius","containedInCircles","arcArea","polygonArea","arcs","center","getCenter","angle","atan2","p2","p1","midPoint","arc","indexOf","circle","a1","a2","angleDiff","PI","sin","cos","circleArea","smallest","disjoint","area","acos","circleOverlap","r1","r2","d","min","h","y0","rx","ry","points","distanceFromIntersectArea","overlap","tolerance","fA","fB","delta","mid","fMid","bisect","bestInitialLayout","areas","set","loss","lossFunction","setOverlaps","sets","rowid","size","weight","hasOwnProperty","left","right","mostOverlapped","positioned","isPositioned","element","positionSet","index","setIndex","d1","d2","extraPoints","l","bestLoss","bestPoint","localLoss","greedyLayout","constrained","restarts","setids","matrices","distances","constraints","getDistanceMatrices","norm","row","best","obj","xi","yi","xj","yj","dij","constraint","squaredDistance","constrainedMDSGradient","random","positions","constrainedMDSLayout","overlaps","output","orientateCircles","orientation","orientationOrder","largestX","largestY","rotation","s","slope","getBoundingBox","minMax","apply","xRange","yRange","none","selector","querySelector","empty","querySelectorAll","matches","update","EnterNode","parent","datum","ownerDocument","namespaceURI","_next","_parent","__data__","bindIndex","group","enter","exit","data","node","groupLength","dataLength","bindKey","key","keyValue","nodeByKeyValue","keyValues","call","ascending","NaN","prototype","constructor","appendChild","child","insertBefore","xhtml","svg","xlink","xml","xmlns","name","prefix","namespaces","space","local","attrRemove","removeAttribute","attrRemoveNS","fullname","removeAttributeNS","attrConstant","setAttribute","attrConstantNS","setAttributeNS","attrFunction","v","arguments","attrFunctionNS","defaultView","document","styleRemove","style","removeProperty","styleConstant","priority","setProperty","styleFunction","styleValue","getPropertyValue","getComputedStyle","propertyRemove","propertyConstant","propertyFunction","classArray","string","trim","split","classList","ClassList","_node","_names","getAttribute","classedAdd","names","list","n","add","classedRemove","remove","classedTrue","classedFalse","classedFunction","textRemove","textContent","textConstant","textFunction","htmlRemove","innerHTML","htmlConstant","htmlFunction","raise","nextSibling","parentNode","lower","previousSibling","firstChild","creatorInherit","uri","documentElement","createElement","createElementNS","creatorFixed","namespace","constantNull","removeChild","selection_cloneShallow","clone","cloneNode","selection_cloneDeep","join","splice","contains","filterEvents","filterContextListener","listener","contextListener","event","related","relatedTarget","compareDocumentPosition","event1","event0","parseTypenames","typenames","t","type","onRemove","typename","on","__on","o","m","removeEventListener","capture","onAdd","wrap","addEventListener","dispatchEvent","window","CustomEvent","createEvent","initEvent","bubbles","cancelable","detail","dispatchConstant","dispatchFunction","mouseenter","mouseleave","root","Selection","groups","parents","_groups","_parents","selection","select","subgroups","subnode","subgroup","selectAll","selectorAll","match","matcher","each","enterGroup","updateGroup","previous","i0","i1","_enter","_exit","sparse","onenter","onupdate","onexit","append","merge","order","groups0","groups1","m0","m1","merges","group0","group1","compare","compareNode","sortgroups","sortgroup","callback","nodes","attr","getAttributeNS","property","classed","html","create","creator","insert","before","deep","dispatch","noop","_","test","Error","Dispatch","types","get","concat","T","copy","that","args","taskHead","taskTail","timeout","interval","clockLast","clockNow","clockSkew","clock","performance","now","Date","setFrame","requestAnimationFrame","setTimeout","clearNow","Timer","_call","_time","timer","delay","time","restart","wake","e","timerFlush","t0","t2","t1","Infinity","sleep","nap","poke","clearTimeout","clearInterval","setInterval","elapsed","stop","TypeError","emptyOn","emptyTween","timing","schedules","__transition","self","tween","start","tick","duration","ease","init","schedule","cssNode","cssRoot","cssView","svgNode","degrees","identity","translateX","translateY","rotate","skewX","scaleX","scaleY","atan","interpolateTransform","parse","pxComma","pxParen","degParen","pop","q","xa","ya","xb","yb","number","translate","interpolateTransformCss","transform","decompose","interpolateTransformSvg","baseVal","consolidate","matrix","tweenRemove","tween0","tween1","tweenFunction","tweenValue","transition","_id","factory","extend","definition","Object","Color","darker","brighter","reI","reN","reP","reHex","reRgbInteger","RegExp","reRgbPercent","reRgbaInteger","reRgbaPercent","reHslPercent","reHslaPercent","named","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","color_formatHex","rgb","formatHex","color_formatRgb","formatRgb","color","format","toLowerCase","exec","parseInt","rgbn","Rgb","rgba","hsla","g","rgbConvert","opacity","rgb_formatHex","hex","rgb_formatRgb","isNaN","round","toString","Hsl","hslConvert","hsl2rgb","m2","basis","v0","v3","t3","nogamma","linear","channels","assign","displayable","formatHsl","pow","rgbGamma","exponential","gamma","end","rgbSpline","spline","values","floor","reA","reB","source","am","bm","bs","bi","lastIndex","one","zero","interpolate","value1","string00","interpolate0","string1","string0","string10","attrInterpolate","attrInterpolateNS","attrTweenNS","_value","attrTween","delayFunction","delayConstant","durationFunction","durationConstant","easeConstant","onFunction","on0","on1","sit","every","styleInterpolate","styleTween","textInterpolate","textTween","_name","newId","selection_prototype","children","inherit","id0","id1","styleNull","listener0","styleMaybeRemove","removeFunction","Promise","resolve","reject","cancel","interrupt","defaultTiming","circleMargin","interior","exterior","margin","computeTextCentre","solution","valid","areaStats","computeTextCentres","overlapped","circleids","circleid","getOverlappingCircles","areaids","exclude","setid","centre","console","log","active","Container","slicesContainer","Graphics","position","isMeasured","_makeSlices","_makeLabels","_defaultThemes","VennDefaultTheme","new","fields","_afterNew","dataItem","slices","make","events","_hovered","target","_updateHover","hoverGraphics","hide","updateLegendMarker","_setDataItem","show","toFront","label","labelsContainer","labels","List","Template","themeTags","template","Label","processDataItem","setRaw","makeSlice","makeLabel","_prepareChildren","_valuesDirty","_sizeDirty","dataItems","intersections","newSets","_sets","vennData","initialLayout","ids","pairs","addMissingAreas","padding","bounds","xScaling","yScaling","scaling","xOffset","yOffset","scaled","clusters","find","maxDistance","xRoot","yRoot","disjointClusters","disjointCluster","returnBounds","spacing","addCluster","cluster","bottom","centreing","innerWidth","innerHeight","item","getDataItemByCategory","_setDefault","cc","intersectionPath","circlePath","wide","svgPath","updateLegendValue","promises","showDataItem","easing","animation","animate","to","waitForStop","cat","di","isHidden","dii","all","hideDataItem","hiddenState","states","disposeDataItem","removeValue","dispose","legendDataItem","setting","hover","unhover","Series","Venn","className","am5venn"],"mappings":"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","file":"venn.js","sourcesContent":["import { Theme } from \"../../core/Theme\";\r\nimport { p50, p100 } from \"../../core/util/Percent\";\r\nimport { ColorSet } from \"../../core/util/ColorSet\";\r\n\r\n\r\n/**\r\n * @ignore\r\n */\r\nexport class VennDefaultTheme extends Theme {\r\n\tprotected setupDefaultRules() {\r\n\t\tsuper.setupDefaultRules();\r\n\t\tconst r = this.rule.bind(this);\r\n\r\n\t\tr(\"Venn\").setAll({\r\n\t\t\tlegendLabelText: \"{category}\",\r\n\t\t\tlegendValueText: \"{value}\",\r\n\t\t\tcolors: ColorSet.new(this._root, {}),\r\n\t\t\twidth: p100,\r\n\t\t\theight: p100\r\n\t\t});\r\n\r\n\r\n\t\tr(\"Label\", [\"venn\"]).setAll({\r\n\t\t\ttext: \"{category}\",\r\n\t\t\tpopulateText: true,\r\n\t\t\tcenterX: p50,\r\n\t\t\tcenterY: p50\r\n\t\t});\r\n\r\n\t}\r\n}\r\n","// need some basic operations on vectors, rather than adding a dependency,\n// just define here\nexport function zeros(x) { var r = new Array(x); for (var i = 0; i < x; ++i) { r[i] = 0; } return r; }\nexport function zerosM(x,y) { return zeros(x).map(function() { return zeros(y); }); }\n\nexport function dot(a, b) {\n    var ret = 0;\n    for (var i = 0; i < a.length; ++i) {\n        ret += a[i] * b[i];\n    }\n    return ret;\n}\n\nexport function norm2(a)  {\n    return Math.sqrt(dot(a, a));\n}\n\nexport function scale(ret, value, c) {\n    for (var i = 0; i < value.length; ++i) {\n        ret[i] = value[i] * c;\n    }\n}\n\nexport function weightedSum(ret, w1, v1, w2, v2) {\n    for (var j = 0; j < ret.length; ++j) {\n        ret[j] = w1 * v1[j] + w2 * v2[j];\n    }\n}\n","import {dot, norm2, weightedSum} from \"./blas1\";\n\n/** minimizes a function using the downhill simplex method */\nexport function nelderMead(f, x0, parameters) {\n    parameters = parameters || {};\n\n    var maxIterations = parameters.maxIterations || x0.length * 200,\n        nonZeroDelta = parameters.nonZeroDelta || 1.05,\n        zeroDelta = parameters.zeroDelta || 0.001,\n        minErrorDelta = parameters.minErrorDelta || 1e-6,\n        minTolerance = parameters.minErrorDelta || 1e-5,\n        rho = (parameters.rho !== undefined) ? parameters.rho : 1,\n        chi = (parameters.chi !== undefined) ? parameters.chi : 2,\n        psi = (parameters.psi !== undefined) ? parameters.psi : -0.5,\n        sigma = (parameters.sigma !== undefined) ? parameters.sigma : 0.5,\n        maxDiff;\n\n    // initialize simplex.\n    var N = x0.length,\n        simplex = new Array(N + 1);\n    simplex[0] = x0;\n    simplex[0].fx = f(x0);\n    simplex[0].id = 0;\n    for (var i = 0; i < N; ++i) {\n        var point = x0.slice();\n        point[i] = point[i] ? point[i] * nonZeroDelta : zeroDelta;\n        simplex[i+1] = point;\n        simplex[i+1].fx = f(point);\n        simplex[i+1].id = i+1;\n    }\n\n    function updateSimplex(value) {\n        for (var i = 0; i < value.length; i++) {\n            simplex[N][i] = value[i];\n        }\n        simplex[N].fx = value.fx;\n    }\n\n    var sortOrder = function(a, b) { return a.fx - b.fx; };\n\n    var centroid = x0.slice(),\n        reflected = x0.slice(),\n        contracted = x0.slice(),\n        expanded = x0.slice();\n\n    for (var iteration = 0; iteration < maxIterations; ++iteration) {\n        simplex.sort(sortOrder);\n\n        if (parameters.history) {\n            // copy the simplex (since later iterations will mutate) and\n            // sort it to have a consistent order between iterations\n            var sortedSimplex = simplex.map(function (x) {\n                var state = x.slice();\n                state.fx = x.fx;\n                state.id = x.id;\n                return state;\n            });\n            sortedSimplex.sort(function(a,b) { return a.id - b.id; });\n\n            parameters.history.push({x: simplex[0].slice(),\n                                     fx: simplex[0].fx,\n                                     simplex: sortedSimplex});\n        }\n\n        maxDiff = 0;\n        for (i = 0; i < N; ++i) {\n            maxDiff = Math.max(maxDiff, Math.abs(simplex[0][i] - simplex[1][i]));\n        }\n\n        if ((Math.abs(simplex[0].fx - simplex[N].fx) < minErrorDelta) &&\n            (maxDiff < minTolerance)) {\n            break;\n        }\n\n        // compute the centroid of all but the worst point in the simplex\n        for (i = 0; i < N; ++i) {\n            centroid[i] = 0;\n            for (var j = 0; j < N; ++j) {\n                centroid[i] += simplex[j][i];\n            }\n            centroid[i] /= N;\n        }\n\n        // reflect the worst point past the centroid  and compute loss at reflected\n        // point\n        var worst = simplex[N];\n        weightedSum(reflected, 1+rho, centroid, -rho, worst);\n        reflected.fx = f(reflected);\n\n        // if the reflected point is the best seen, then possibly expand\n        if (reflected.fx < simplex[0].fx) {\n            weightedSum(expanded, 1+chi, centroid, -chi, worst);\n            expanded.fx = f(expanded);\n            if (expanded.fx < reflected.fx) {\n                updateSimplex(expanded);\n            }  else {\n                updateSimplex(reflected);\n            }\n        }\n\n        // if the reflected point is worse than the second worst, we need to\n        // contract\n        else if (reflected.fx >= simplex[N-1].fx) {\n            var shouldReduce = false;\n\n            if (reflected.fx > worst.fx) {\n                // do an inside contraction\n                weightedSum(contracted, 1+psi, centroid, -psi, worst);\n                contracted.fx = f(contracted);\n                if (contracted.fx < worst.fx) {\n                    updateSimplex(contracted);\n                } else {\n                    shouldReduce = true;\n                }\n            } else {\n                // do an outside contraction\n                weightedSum(contracted, 1-psi * rho, centroid, psi*rho, worst);\n                contracted.fx = f(contracted);\n                if (contracted.fx < reflected.fx) {\n                    updateSimplex(contracted);\n                } else {\n                    shouldReduce = true;\n                }\n            }\n\n            if (shouldReduce) {\n                // if we don't contract here, we're done\n                if (sigma >= 1) break;\n\n                // do a reduction\n                for (i = 1; i < simplex.length; ++i) {\n                    weightedSum(simplex[i], 1 - sigma, simplex[0], sigma, simplex[i]);\n                    simplex[i].fx = f(simplex[i]);\n                }\n            }\n        } else {\n            updateSimplex(reflected);\n        }\n    }\n\n    simplex.sort(sortOrder);\n    return {fx : simplex[0].fx,\n            x : simplex[0]};\n}\n","import {dot, weightedSum} from \"./blas1\";\n\n\n/// searches along line 'pk' for a point that satifies the wolfe conditions\n/// See 'Numerical Optimization' by Nocedal and Wright p59-60\n/// f : objective function\n/// pk : search direction\n/// current: object containing current gradient/loss\n/// next: output: contains next gradient/loss\n/// returns a: step size taken\nexport function wolfeLineSearch(f, pk, current, next, a, c1, c2) {\n    var phi0 = current.fx, phiPrime0 = dot(current.fxprime, pk),\n        phi = phi0, phi_old = phi0,\n        phiPrime = phiPrime0,\n        a0 = 0;\n\n    a = a || 1;\n    c1 = c1 || 1e-6;\n    c2 = c2 || 0.1;\n\n    function zoom(a_lo, a_high, phi_lo) {\n        for (var iteration = 0; iteration < 16; ++iteration) {\n            a = (a_lo + a_high)/2;\n            weightedSum(next.x, 1.0, current.x, a, pk);\n            phi = next.fx = f(next.x, next.fxprime);\n            phiPrime = dot(next.fxprime, pk);\n\n            if ((phi > (phi0 + c1 * a * phiPrime0)) ||\n                (phi >= phi_lo)) {\n                a_high = a;\n\n            } else  {\n                if (Math.abs(phiPrime) <= -c2 * phiPrime0) {\n                    return a;\n                }\n\n                if (phiPrime * (a_high - a_lo) >=0) {\n                    a_high = a_lo;\n                }\n\n                a_lo = a;\n                phi_lo = phi;\n            }\n        }\n\n        return 0;\n    }\n\n    for (var iteration = 0; iteration < 10; ++iteration) {\n        weightedSum(next.x, 1.0, current.x, a, pk);\n        phi = next.fx = f(next.x, next.fxprime);\n        phiPrime = dot(next.fxprime, pk);\n        if ((phi > (phi0 + c1 * a * phiPrime0)) ||\n            (iteration && (phi >= phi_old))) {\n            return zoom(a0, a, phi_old);\n        }\n\n        if (Math.abs(phiPrime) <= -c2 * phiPrime0) {\n            return a;\n        }\n\n        if (phiPrime >= 0 ) {\n            return zoom(a, a0, phi);\n        }\n\n        phi_old = phi;\n        a0 = a;\n        a *= 2;\n    }\n\n    return a;\n}\n","import {dot, norm2, scale, weightedSum} from \"./blas1\";\nimport {wolfeLineSearch} from \"./linesearch\";\n\nexport function conjugateGradient(f, initial, params) {\n    // allocate all memory up front here, keep out of the loop for perfomance\n    // reasons\n    var current = {x: initial.slice(), fx: 0, fxprime: initial.slice()},\n        next = {x: initial.slice(), fx: 0, fxprime: initial.slice()},\n        yk = initial.slice(),\n        pk, temp,\n        a = 1,\n        maxIterations;\n\n    params = params || {};\n    maxIterations = params.maxIterations || initial.length * 20;\n\n    current.fx = f(current.x, current.fxprime);\n    pk = current.fxprime.slice();\n    scale(pk, current.fxprime,-1);\n\n    for (var i = 0; i < maxIterations; ++i) {\n        a = wolfeLineSearch(f, pk, current, next, a);\n\n        // todo: history in wrong spot?\n        if (params.history) {\n            params.history.push({x: current.x.slice(),\n                                 fx: current.fx,\n                                 fxprime: current.fxprime.slice(),\n                                 alpha: a});\n        }\n\n        if (!a) {\n            // faiiled to find point that satifies wolfe conditions.\n            // reset direction for next iteration\n            scale(pk, current.fxprime, -1);\n\n        } else {\n            // update direction using PolakRibiere CG method\n            weightedSum(yk, 1, next.fxprime, -1, current.fxprime);\n\n            var delta_k = dot(current.fxprime, current.fxprime),\n                beta_k = Math.max(0, dot(yk, next.fxprime) / delta_k);\n\n            weightedSum(pk, beta_k, pk, -1, next.fxprime);\n\n            temp = current;\n            current = next;\n            next = temp;\n        }\n\n        if (norm2(current.fxprime) <= 1e-5) {\n            break;\n        }\n    }\n\n    if (params.history) {\n        params.history.push({x: current.x.slice(),\n                             fx: current.fx,\n                             fxprime: current.fxprime.slice(),\n                             alpha: a});\n    }\n\n    return current;\n}\n","var SMALL = 1e-10;\n\n/** Returns the intersection area of a bunch of circles (where each circle\n is an object having an x,y and radius property) */\nexport function intersectionArea(circles, stats) {\n    // get all the intersection points of the circles\n    var intersectionPoints = getIntersectionPoints(circles);\n\n    // filter out points that aren't included in all the circles\n    var innerPoints = intersectionPoints.filter(function (p) {\n        return containedInCircles(p, circles);\n    });\n\n    var arcArea = 0, polygonArea = 0, arcs = [], i;\n\n    // if we have intersection points that are within all the circles,\n    // then figure out the area contained by them\n    if (innerPoints.length > 1) {\n        // sort the points by angle from the center of the polygon, which lets\n        // us just iterate over points to get the edges\n        var center = getCenter(innerPoints);\n        for (i = 0; i < innerPoints.length; ++i ) {\n            var p = innerPoints[i];\n            p.angle = Math.atan2(p.x - center.x, p.y - center.y);\n        }\n        innerPoints.sort(function(a,b) { return b.angle - a.angle;});\n\n        // iterate over all points, get arc between the points\n        // and update the areas\n        var p2 = innerPoints[innerPoints.length - 1];\n        for (i = 0; i < innerPoints.length; ++i) {\n            var p1 = innerPoints[i];\n\n            // polygon area updates easily ...\n            polygonArea += (p2.x + p1.x) * (p1.y - p2.y);\n\n            // updating the arc area is a little more involved\n            var midPoint = {x : (p1.x + p2.x) / 2,\n                            y : (p1.y + p2.y) / 2},\n                arc = null;\n\n            for (var j = 0; j < p1.parentIndex.length; ++j) {\n                if (p2.parentIndex.indexOf(p1.parentIndex[j]) > -1) {\n                    // figure out the angle halfway between the two points\n                    // on the current circle\n                    var circle = circles[p1.parentIndex[j]],\n                        a1 = Math.atan2(p1.x - circle.x, p1.y - circle.y),\n                        a2 = Math.atan2(p2.x - circle.x, p2.y - circle.y);\n\n                    var angleDiff = (a2 - a1);\n                    if (angleDiff < 0) {\n                        angleDiff += 2*Math.PI;\n                    }\n\n                    // and use that angle to figure out the width of the\n                    // arc\n                    var a = a2 - angleDiff/2,\n                        width = distance(midPoint, {\n                            x : circle.x + circle.radius * Math.sin(a),\n                            y : circle.y + circle.radius * Math.cos(a)\n                        });\n\n                    // clamp the width to the largest is can actually be\n                    // (sometimes slightly overflows because of FP errors)\n                    if (width > circle.radius * 2) {\n                        width = circle.radius * 2;\n                    }\n\n                    // pick the circle whose arc has the smallest width\n                    if ((arc === null) || (arc.width > width)) {\n                        arc = { circle : circle,\n                                width : width,\n                                p1 : p1,\n                                p2 : p2};\n                    }\n                }\n            }\n\n            if (arc !== null) {\n                arcs.push(arc);\n                arcArea += circleArea(arc.circle.radius, arc.width);\n                p2 = p1;\n            }\n        }\n    } else {\n        // no intersection points, is either disjoint - or is completely\n        // overlapped. figure out which by examining the smallest circle\n        var smallest = circles[0];\n        for (i = 1; i < circles.length; ++i) {\n            if (circles[i].radius < smallest.radius) {\n                smallest = circles[i];\n            }\n        }\n\n        // make sure the smallest circle is completely contained in all\n        // the other circles\n        var disjoint = false;\n        for (i = 0; i < circles.length; ++i) {\n            if (distance(circles[i], smallest) > Math.abs(smallest.radius - circles[i].radius)) {\n                disjoint = true;\n                break;\n            }\n        }\n\n        if (disjoint) {\n            arcArea = polygonArea = 0;\n\n        } else {\n            arcArea = smallest.radius * smallest.radius * Math.PI;\n            arcs.push({circle : smallest,\n                       p1: { x: smallest.x,        y : smallest.y + smallest.radius},\n                       p2: { x: smallest.x - SMALL, y : smallest.y + smallest.radius},\n                       width : smallest.radius * 2 });\n        }\n    }\n\n    polygonArea /= 2;\n    if (stats) {\n        stats.area = arcArea + polygonArea;\n        stats.arcArea = arcArea;\n        stats.polygonArea = polygonArea;\n        stats.arcs = arcs;\n        stats.innerPoints = innerPoints;\n        stats.intersectionPoints = intersectionPoints;\n    }\n\n    return arcArea + polygonArea;\n}\n\n/** returns whether a point is contained by all of a list of circles */\nexport function containedInCircles(point, circles) {\n    for (var i = 0; i < circles.length; ++i) {\n        if (distance(point, circles[i]) > circles[i].radius + SMALL) {\n            return false;\n        }\n    }\n    return true;\n}\n\n/** Gets all intersection points between a bunch of circles */\nfunction getIntersectionPoints(circles) {\n    var ret = [];\n    for (var i = 0; i < circles.length; ++i) {\n        for (var j = i + 1; j < circles.length; ++j) {\n            var intersect = circleCircleIntersection(circles[i],\n                                                          circles[j]);\n            for (var k = 0; k < intersect.length; ++k) {\n                var p = intersect[k];\n                p.parentIndex = [i,j];\n                ret.push(p);\n            }\n        }\n    }\n    return ret;\n}\n\n/** Circular segment area calculation. See http://mathworld.wolfram.com/CircularSegment.html */\nexport function circleArea(r, width) {\n    return r * r * Math.acos(1 - width/r) - (r - width) * Math.sqrt(width * (2 * r - width));\n}\n\n/** euclidean distance between two points */\nexport function distance(p1, p2) {\n    return Math.sqrt((p1.x - p2.x) * (p1.x - p2.x) +\n                     (p1.y - p2.y) * (p1.y - p2.y));\n}\n\n\n/** Returns the overlap area of two circles of radius r1 and r2 - that\nhave their centers separated by distance d. Simpler faster\ncircle intersection for only two circles */\nexport function circleOverlap(r1, r2, d) {\n    // no overlap\n    if (d >= r1 + r2) {\n        return 0;\n    }\n\n    // completely overlapped\n    if (d <= Math.abs(r1 - r2)) {\n        return Math.PI * Math.min(r1, r2) * Math.min(r1, r2);\n    }\n\n    var w1 = r1 - (d * d - r2 * r2 + r1 * r1) / (2 * d),\n        w2 = r2 - (d * d - r1 * r1 + r2 * r2) / (2 * d);\n    return circleArea(r1, w1) + circleArea(r2, w2);\n}\n\n/** Given two circles (containing a x/y/radius attributes),\nreturns the intersecting points if possible.\nnote: doesn't handle cases where there are infinitely many\nintersection points (circles are equivalent):, or only one intersection point*/\nexport function circleCircleIntersection(p1, p2) {\n    var d = distance(p1, p2),\n        r1 = p1.radius,\n        r2 = p2.radius;\n\n    // if to far away, or self contained - can't be done\n    if ((d >= (r1 + r2)) || (d <= Math.abs(r1 - r2))) {\n        return [];\n    }\n\n    var a = (r1 * r1 - r2 * r2 + d * d) / (2 * d),\n        h = Math.sqrt(r1 * r1 - a * a),\n        x0 = p1.x + a * (p2.x - p1.x) / d,\n        y0 = p1.y + a * (p2.y - p1.y) / d,\n        rx = -(p2.y - p1.y) * (h / d),\n        ry = -(p2.x - p1.x) * (h / d);\n\n    return [{x: x0 + rx, y : y0 - ry },\n            {x: x0 - rx, y : y0 + ry }];\n}\n\n/** Returns the center of a bunch of points */\nexport function getCenter(points) {\n    var center = {x: 0, y: 0};\n    for (var i =0; i < points.length; ++i ) {\n        center.x += points[i].x;\n        center.y += points[i].y;\n    }\n    center.x /= points.length;\n    center.y /= points.length;\n    return center;\n}\n","import {nelderMead, bisect, conjugateGradient, zeros, zerosM, norm2,\n        scale} from './fmin/index.js';\nimport {intersectionArea, circleOverlap, circleCircleIntersection, distance} from './circleintersection';\n\n/** given a list of set objects, and their corresponding overlaps.\nupdates the (x, y, radius) attribute on each set such that their positions\nroughly correspond to the desired overlaps */\nexport function venn(areas, parameters) {\n    parameters = parameters || {};\n    parameters.maxIterations = parameters.maxIterations || 500;\n    var initialLayout = parameters.initialLayout || bestInitialLayout;\n    var loss = parameters.lossFunction || lossFunction;\n\n    // add in missing pairwise areas as having 0 size\n    areas = addMissingAreas(areas);\n\n    // initial layout is done greedily\n    var circles = initialLayout(areas, parameters);\n\n    // transform x/y coordinates to a vector to optimize\n    var initial = [], setids = [], setid;\n    for (setid in circles) {\n        if (circles.hasOwnProperty(setid)) {\n            initial.push(circles[setid].x);\n            initial.push(circles[setid].y);\n            setids.push(setid);\n        }\n    }\n\n    // optimize initial layout from our loss function\n    var totalFunctionCalls = 0;\n    var solution = nelderMead(\n        function(values) {\n            totalFunctionCalls += 1;\n            var current = {};\n            for (var i = 0; i < setids.length; ++i) {\n                var setid = setids[i];\n                current[setid] = {x: values[2 * i],\n                                  y: values[2 * i + 1],\n                                  radius : circles[setid].radius,\n                                 // size : circles[setid].size\n                                 };\n            }\n            return loss(current, areas);\n        },\n        initial,\n        parameters);\n\n    // transform solution vector back to x/y points\n    var positions = solution.x;\n    for (var i = 0; i < setids.length; ++i) {\n        setid = setids[i];\n        circles[setid].x = positions[2 * i];\n        circles[setid].y = positions[2 * i + 1];\n    }\n\n    return circles;\n}\n\nvar SMALL = 1e-10;\n\n/** Returns the distance necessary for two circles of radius r1 + r2 to\nhave the overlap area 'overlap' */\nexport function distanceFromIntersectArea(r1, r2, overlap) {\n    // handle complete overlapped circles\n    if (Math.min(r1, r2) * Math.min(r1,r2) * Math.PI <= overlap + SMALL) {\n        return Math.abs(r1 - r2);\n    }\n\n    return bisect(function(distance) {\n        return circleOverlap(r1, r2, distance) - overlap;\n    }, 0, r1 + r2);\n}\n\n/** Missing pair-wise intersection area data can cause problems:\n treating as an unknown means that sets will be laid out overlapping,\n which isn't what people expect. To reflect that we want disjoint sets\n here, set the overlap to 0 for all missing pairwise set intersections */\nfunction addMissingAreas(areas) {\n    areas = areas.slice();\n\n    // two circle intersections that aren't defined\n    var ids = [], pairs = {}, i, j, a, b;\n    for (i = 0; i < areas.length; ++i) {\n        var area = areas[i];\n        if (area.sets.length == 1) {\n            ids.push(area.sets[0]);\n        } else if (area.sets.length == 2) {\n            a = area.sets[0];\n            b = area.sets[1];\n            pairs[[a, b]] = true;\n            pairs[[b, a]] = true;\n        }\n    }\n    ids.sort(function(a, b) { return a > b; });\n\n    for (i = 0; i < ids.length; ++i) {\n        a = ids[i];\n        for (j = i + 1; j < ids.length; ++j) {\n            b = ids[j];\n            if (!([a, b] in pairs)) {\n                areas.push({'sets': [a, b],\n                            'size': 0});\n            }\n        }\n    }\n    return areas;\n}\n\n/// Returns two matrices, one of the euclidean distances between the sets\n/// and the other indicating if there are subset or disjoint set relationships\nexport function getDistanceMatrices(areas, sets, setids) {\n    // initialize an empty distance matrix between all the points\n    var distances = zerosM(sets.length, sets.length),\n        constraints = zerosM(sets.length, sets.length);\n\n    // compute required distances between all the sets such that\n    // the areas match\n    areas.filter(function(x) { return x.sets.length == 2; })\n        .map(function(current) {\n        var left = setids[current.sets[0]],\n            right = setids[current.sets[1]],\n            r1 = Math.sqrt(sets[left].size / Math.PI),\n            r2 = Math.sqrt(sets[right].size / Math.PI),\n            distance = distanceFromIntersectArea(r1, r2, current.size);\n\n        distances[left][right] = distances[right][left] = distance;\n\n        // also update constraints to indicate if its a subset or disjoint\n        // relationship\n        var c = 0;\n        if (current.size + 1e-10 >= Math.min(sets[left].size,\n                                             sets[right].size)) {\n            c = 1;\n        } else if (current.size <= 1e-10) {\n            c = -1;\n        }\n        constraints[left][right] = constraints[right][left] = c;\n    });\n\n    return {distances: distances, constraints: constraints};\n}\n\n/// computes the gradient and loss simulatenously for our constrained MDS optimizer\nfunction constrainedMDSGradient(x, fxprime, distances, constraints) {\n    var loss = 0, i;\n    for (i = 0; i < fxprime.length; ++i) {\n        fxprime[i] = 0;\n    }\n\n    for (i = 0; i < distances.length; ++i) {\n        var xi = x[2 * i], yi = x[2 * i + 1];\n        for (var j = i + 1; j < distances.length; ++j) {\n            var xj = x[2 * j], yj = x[2 * j + 1],\n                dij = distances[i][j],\n                constraint = constraints[i][j];\n\n            var squaredDistance = (xj - xi) * (xj - xi) + (yj - yi) * (yj - yi),\n                distance = Math.sqrt(squaredDistance),\n                delta = squaredDistance - dij * dij;\n\n            if (((constraint > 0) && (distance <= dij)) ||\n                ((constraint < 0) && (distance >= dij))) {\n                continue;\n            }\n\n            loss += 2 * delta * delta;\n\n            fxprime[2*i]     += 4 * delta * (xi - xj);\n            fxprime[2*i + 1] += 4 * delta * (yi - yj);\n\n            fxprime[2*j]     += 4 * delta * (xj - xi);\n            fxprime[2*j + 1] += 4 * delta * (yj - yi);\n        }\n    }\n    return loss;\n}\n\n/// takes the best working variant of either constrained MDS or greedy\nexport function bestInitialLayout(areas, params) {\n    var initial = greedyLayout(areas, params);\n    var loss = params.lossFunction || lossFunction;\n\n    // greedylayout is sufficient for all 2/3 circle cases. try out\n    // constrained MDS for higher order problems, take its output\n    // if it outperforms. (greedy is aesthetically better on 2/3 circles\n    // since it axis aligns)\n    if (areas.length >= 8) {\n        var constrained  = constrainedMDSLayout(areas, params),\n            constrainedLoss = loss(constrained, areas),\n            greedyLoss = loss(initial, areas);\n\n        if (constrainedLoss + 1e-8 < greedyLoss) {\n            initial = constrained;\n        }\n    }\n    return initial;\n}\n\n/// use the constrained MDS variant to generate an initial layout\nexport function constrainedMDSLayout(areas, params) {\n    params = params || {};\n    var restarts = params.restarts || 10;\n\n    // bidirectionally map sets to a rowid  (so we can create a matrix)\n    var sets = [], setids = {}, i;\n    for (i = 0; i < areas.length; ++i ) {\n        var area = areas[i];\n        if (area.sets.length == 1) {\n            setids[area.sets[0]] = sets.length;\n            sets.push(area);\n        }\n    }\n\n    var matrices = getDistanceMatrices(areas, sets, setids),\n        distances = matrices.distances,\n        constraints = matrices.constraints;\n\n    // keep distances bounded, things get messed up otherwise.\n    // TODO: proper preconditioner?\n    var norm = norm2(distances.map(norm2))/(distances.length);\n    distances = distances.map(function (row) {\n        return row.map(function (value) { return value / norm; });});\n\n    var obj = function(x, fxprime) {\n        return constrainedMDSGradient(x, fxprime, distances, constraints);\n    };\n\n    var best, current;\n    for (i = 0; i < restarts; ++i) {\n        var initial = zeros(distances.length*2).map(Math.random);\n\n        current = conjugateGradient(obj, initial, params);\n        if (!best || (current.fx < best.fx)) {\n            best = current;\n        }\n    }\n    var positions = best.x;\n\n    // translate rows back to (x,y,radius) coordinates\n    var circles = {};\n    for (i = 0; i < sets.length; ++i) {\n        var set = sets[i];\n        circles[set.sets[0]] = {\n            x: positions[2*i] * norm,\n            y: positions[2*i + 1] * norm,\n            radius:  Math.sqrt(set.size / Math.PI)\n        };\n    }\n\n    if (params.history) {\n        for (i = 0; i < params.history.length; ++i) {\n            scale(params.history[i].x, norm);\n        }\n    }\n    return circles;\n}\n\n/** Lays out a Venn diagram greedily, going from most overlapped sets to\nleast overlapped, attempting to position each new set such that the\noverlapping areas to already positioned sets are basically right */\nexport function greedyLayout(areas, params) {\n    var loss = params && params.lossFunction ? params.lossFunction : lossFunction;\n    // define a circle for each set\n    var circles = {}, setOverlaps = {}, set;\n    for (var i = 0; i < areas.length; ++i) {\n        var area = areas[i];\n        if (area.sets.length == 1) {\n            set = area.sets[0];\n            circles[set] = {x: 1e10, y: 1e10,\n                            rowid: circles.length,\n                            size: area.size,\n                            radius: Math.sqrt(area.size / Math.PI)};\n            setOverlaps[set] = [];\n        }\n    }\n    areas = areas.filter(function(a) { return a.sets.length == 2; });\n\n    // map each set to a list of all the other sets that overlap it\n    for (i = 0; i < areas.length; ++i) {\n        var current = areas[i];\n        var weight = current.hasOwnProperty('weight') ? current.weight : 1.0;\n        var left = current.sets[0], right = current.sets[1];\n\n        // completely overlapped circles shouldn't be positioned early here\n        if (current.size + SMALL >= Math.min(circles[left].size,\n                                             circles[right].size)) {\n            weight = 0;\n        }\n\n        setOverlaps[left].push ({set:right, size:current.size, weight:weight});\n        setOverlaps[right].push({set:left,  size:current.size, weight:weight});\n    }\n\n    // get list of most overlapped sets\n    var mostOverlapped = [];\n    for (set in setOverlaps) {\n        if (setOverlaps.hasOwnProperty(set)) {\n            var size = 0;\n            for (i = 0; i < setOverlaps[set].length; ++i) {\n                size += setOverlaps[set][i].size * setOverlaps[set][i].weight;\n            }\n\n            mostOverlapped.push({set: set, size:size});\n        }\n    }\n\n    // sort by size desc\n    function sortOrder(a,b) {\n        return b.size - a.size;\n    }\n    mostOverlapped.sort(sortOrder);\n\n    // keep track of what sets have been laid out\n    var positioned = {};\n    function isPositioned(element) {\n        return element.set in positioned;\n    }\n\n    // adds a point to the output\n    function positionSet(point, index) {\n        circles[index].x = point.x;\n        circles[index].y = point.y;\n        positioned[index] = true;\n    }\n\n    // add most overlapped set at (0,0)\n    positionSet({x: 0, y: 0}, mostOverlapped[0].set);\n\n    // get distances between all points. TODO, necessary?\n    // answer: probably not\n    // var distances = venn.getDistanceMatrices(circles, areas).distances;\n    for (i = 1; i < mostOverlapped.length; ++i) {\n        var setIndex = mostOverlapped[i].set,\n            overlap = setOverlaps[setIndex].filter(isPositioned);\n        set = circles[setIndex];\n        overlap.sort(sortOrder);\n\n        if (overlap.length === 0) {\n            // this shouldn't happen anymore with addMissingAreas\n            throw \"ERROR: missing pairwise overlap information\";\n        }\n\n        var points = [];\n        for (var j = 0; j < overlap.length; ++j) {\n            // get appropriate distance from most overlapped already added set\n            var p1 = circles[overlap[j].set],\n                d1 = distanceFromIntersectArea(set.radius, p1.radius,\n                                               overlap[j].size);\n\n            // sample positions at 90 degrees for maximum aesthetics\n            points.push({x : p1.x + d1, y : p1.y});\n            points.push({x : p1.x - d1, y : p1.y});\n            points.push({y : p1.y + d1, x : p1.x});\n            points.push({y : p1.y - d1, x : p1.x});\n\n            // if we have at least 2 overlaps, then figure out where the\n            // set should be positioned analytically and try those too\n            for (var k = j + 1; k < overlap.length; ++k) {\n                var p2 = circles[overlap[k].set],\n                    d2 = distanceFromIntersectArea(set.radius, p2.radius,\n                                                   overlap[k].size);\n\n                var extraPoints = circleCircleIntersection(\n                    { x: p1.x, y: p1.y, radius: d1},\n                    { x: p2.x, y: p2.y, radius: d2});\n\n                for (var l = 0; l < extraPoints.length; ++l) {\n                    points.push(extraPoints[l]);\n                }\n            }\n        }\n\n        // we have some candidate positions for the set, examine loss\n        // at each position to figure out where to put it at\n        var bestLoss = 1e50, bestPoint = points[0];\n        for (j = 0; j < points.length; ++j) {\n            circles[setIndex].x = points[j].x;\n            circles[setIndex].y = points[j].y;\n            var localLoss = loss(circles, areas);\n            if (localLoss < bestLoss) {\n                bestLoss = localLoss;\n                bestPoint = points[j];\n            }\n        }\n\n        positionSet(bestPoint, setIndex);\n    }\n\n    return circles;\n}\n\n/** Given a bunch of sets, and the desired overlaps between these sets - computes\nthe distance from the actual overlaps to the desired overlaps. Note that\nthis method ignores overlaps of more than 2 circles */\nexport function lossFunction(sets, overlaps) {\n    var output = 0;\n\n    function getCircles(indices) {\n        return indices.map(function(i) { return sets[i]; });\n    }\n\n    for (var i = 0; i < overlaps.length; ++i) {\n        var area = overlaps[i], overlap;\n        if (area.sets.length == 1) {\n            continue;\n        } else if (area.sets.length == 2) {\n            var left = sets[area.sets[0]],\n                right = sets[area.sets[1]];\n            overlap = circleOverlap(left.radius, right.radius,\n                                    distance(left, right));\n        } else {\n            overlap = intersectionArea(getCircles(area.sets));\n        }\n\n        var weight = area.hasOwnProperty('weight') ? area.weight : 1.0;\n        output += weight * (overlap - area.size) * (overlap - area.size);\n    }\n\n    return output;\n}\n\n// orientates a bunch of circles to point in orientation\nfunction orientateCircles(circles, orientation, orientationOrder) {\n    if (orientationOrder === null) {\n        circles.sort(function (a, b) { return b.radius - a.radius; });\n    } else {\n        circles.sort(orientationOrder);\n    }\n\n    var i;\n    // shift circles so largest circle is at (0, 0)\n    if (circles.length > 0) {\n        var largestX = circles[0].x,\n            largestY = circles[0].y;\n\n        for (i = 0; i < circles.length; ++i) {\n            circles[i].x -= largestX;\n            circles[i].y -= largestY;\n        }\n    }\n\n    if (circles.length == 2) {\n        // if the second circle is a subset of the first, arrange so that\n        // it is off to one side. hack for https://github.com/benfred/venn.js/issues/120\n        var dist = distance(circles[0], circles[1]);\n        if (dist < Math.abs(circles[1].radius - circles[0].radius)) {\n            circles[1].x = circles[0].x + circles[0].radius - circles[1].radius - 1e-10;\n            circles[1].y = circles[0].y;\n        }\n    }\n\n    // rotate circles so that second largest is at an angle of 'orientation'\n    // from largest\n    if (circles.length > 1) {\n        var rotation = Math.atan2(circles[1].x, circles[1].y) - orientation,\n            c = Math.cos(rotation),\n            s = Math.sin(rotation), x, y;\n\n        for (i = 0; i < circles.length; ++i) {\n            x = circles[i].x;\n            y = circles[i].y;\n            circles[i].x = c * x - s * y;\n            circles[i].y = s * x + c * y;\n        }\n    }\n\n    // mirror solution if third solution is above plane specified by\n    // first two circles\n    if (circles.length > 2) {\n        var angle = Math.atan2(circles[2].x, circles[2].y) - orientation;\n        while (angle < 0) { angle += 2* Math.PI; }\n        while (angle > 2*Math.PI) { angle -= 2* Math.PI; }\n        if (angle > Math.PI) {\n            var slope = circles[1].y / (1e-10 + circles[1].x);\n            for (i = 0; i < circles.length; ++i) {\n                var d = (circles[i].x + slope * circles[i].y) / (1 + slope*slope);\n                circles[i].x = 2 * d - circles[i].x;\n                circles[i].y = 2 * d * slope - circles[i].y;\n            }\n        }\n    }\n}\n\nexport function disjointCluster(circles) {\n    // union-find clustering to get disjoint sets\n    circles.map(function(circle) { circle.parent = circle; });\n\n    // path compression step in union find\n    function find(circle) {\n        if (circle.parent !== circle) {\n            circle.parent = find(circle.parent);\n        }\n        return circle.parent;\n    }\n\n    function union(x, y) {\n        var xRoot = find(x), yRoot = find(y);\n        xRoot.parent = yRoot;\n    }\n\n    // get the union of all overlapping sets\n    for (var i = 0; i < circles.length; ++i) {\n        for (var j = i + 1; j < circles.length; ++j) {\n            var maxDistance = circles[i].radius + circles[j].radius;\n            if (distance(circles[i], circles[j]) + 1e-10 < maxDistance) {\n                union(circles[j], circles[i]);\n            }\n        }\n    }\n\n    // find all the disjoint clusters and group them together\n    var disjointClusters = {}, setid;\n    for (i = 0; i < circles.length; ++i) {\n        setid = find(circles[i]).parent.setid;\n        if (!(setid in disjointClusters)) {\n            disjointClusters[setid] = [];\n        }\n        disjointClusters[setid].push(circles[i]);\n    }\n\n    // cleanup bookkeeping\n    circles.map(function(circle) { delete circle.parent; });\n\n    // return in more usable form\n    var ret = [];\n    for (setid in disjointClusters) {\n        if (disjointClusters.hasOwnProperty(setid)) {\n            ret.push(disjointClusters[setid]);\n        }\n    }\n    return ret;\n}\n\nfunction getBoundingBox(circles) {\n    var minMax = function(d) {\n        var hi = Math.max.apply(null, circles.map(\n                                function(c) { return c[d] + c.radius; } )),\n            lo = Math.min.apply(null, circles.map(\n                                function(c) { return c[d] - c.radius;} ));\n        return {max:hi, min:lo};\n    };\n\n    return {xRange: minMax('x'), yRange: minMax('y')};\n}\n\nexport function normalizeSolution(solution, orientation, orientationOrder) {\n    if (orientation === null){\n        orientation = Math.PI/2;\n    }\n\n    // work with a list instead of a dictionary, and take a copy so we\n    // don't mutate input\n    var circles = [], i, setid;\n    for (setid in solution) {\n        if (solution.hasOwnProperty(setid)) {\n            var previous = solution[setid];\n            circles.push({x: previous.x,\n                          y: previous.y,\n                          radius: previous.radius,\n                          setid: setid});\n        }\n    }\n\n    // get all the disjoint clusters\n    var clusters = disjointCluster(circles);\n\n    // orientate all disjoint sets, get sizes\n    for (i = 0; i < clusters.length; ++i) {\n        orientateCircles(clusters[i], orientation, orientationOrder);\n        var bounds = getBoundingBox(clusters[i]);\n        clusters[i].size = (bounds.xRange.max - bounds.xRange.min) * (bounds.yRange.max - bounds.yRange.min);\n        clusters[i].bounds = bounds;\n    }\n    clusters.sort(function(a, b) { return b.size - a.size; });\n\n    // orientate the largest at 0,0, and get the bounds\n    circles = clusters[0];\n    var returnBounds = circles.bounds;\n\n    var spacing = (returnBounds.xRange.max - returnBounds.xRange.min)/50;\n\n    function addCluster(cluster, right, bottom) {\n        if (!cluster) return;\n\n        var bounds = cluster.bounds, xOffset, yOffset, centreing;\n\n        if (right) {\n            xOffset = returnBounds.xRange.max  - bounds.xRange.min + spacing;\n        } else {\n            xOffset = returnBounds.xRange.max  - bounds.xRange.max;\n            centreing = (bounds.xRange.max - bounds.xRange.min) / 2 -\n                        (returnBounds.xRange.max - returnBounds.xRange.min) / 2;\n            if (centreing < 0) xOffset += centreing;\n        }\n\n        if (bottom) {\n            yOffset = returnBounds.yRange.max  - bounds.yRange.min + spacing;\n        } else {\n            yOffset = returnBounds.yRange.max  - bounds.yRange.max;\n            centreing = (bounds.yRange.max - bounds.yRange.min) / 2 -\n                        (returnBounds.yRange.max - returnBounds.yRange.min) / 2;\n            if (centreing < 0) yOffset += centreing;\n        }\n\n        for (var j = 0; j < cluster.length; ++j) {\n            cluster[j].x += xOffset;\n            cluster[j].y += yOffset;\n            circles.push(cluster[j]);\n        }\n    }\n\n    var index = 1;\n    while (index < clusters.length) {\n        addCluster(clusters[index], true, false);\n        addCluster(clusters[index+1], false, true);\n        addCluster(clusters[index+2], true, true);\n        index += 3;\n\n        // have one cluster (in top left). lay out next three relative\n        // to it in a grid\n        returnBounds = getBoundingBox(circles);\n    }\n\n    // convert back to solution form\n    var ret = {};\n    for (i = 0; i < circles.length; ++i) {\n        ret[circles[i].setid] = circles[i];\n    }\n    return ret;\n}\n\n/** Scales a solution from venn.venn or venn.greedyLayout such that it fits in\na rectangle of width/height - with padding around the borders. also\ncenters the diagram in the available space at the same time */\nexport function scaleSolution(solution, width, height, padding) {\n    var circles = [], setids = [];\n    for (var setid in solution) {\n        if (solution.hasOwnProperty(setid)) {\n            setids.push(setid);\n            circles.push(solution[setid]);\n        }\n    }\n\n    width -= 2*padding;\n    height -= 2*padding;\n\n    var bounds = getBoundingBox(circles),\n        xRange = bounds.xRange,\n        yRange = bounds.yRange;\n\n    if ((xRange.max == xRange.min) ||\n        (yRange.max == yRange.min)) {\n        console.log(\"not scaling solution: zero size detected\");\n        return solution;\n    }\n\n    var xScaling = width  / (xRange.max - xRange.min),\n        yScaling = height / (yRange.max - yRange.min),\n        scaling = Math.min(yScaling, xScaling),\n\n        // while we're at it, center the diagram too\n        xOffset = (width -  (xRange.max - xRange.min) * scaling) / 2,\n        yOffset = (height - (yRange.max - yRange.min) * scaling) / 2;\n\n    var scaled = {};\n    for (var i = 0; i < circles.length; ++i) {\n        var circle = circles[i];\n        scaled[setids[i]] = {\n            radius: scaling * circle.radius,\n            x: padding + xOffset + (circle.x - xRange.min) * scaling,\n            y: padding + yOffset + (circle.y - yRange.min) * scaling,\n        };\n    }\n\n    return scaled;\n}\n","/** finds the zeros of a function, given two starting points (which must\n * have opposite signs */\nexport function bisect(f, a, b, parameters) {\n    parameters = parameters || {};\n    var maxIterations = parameters.maxIterations || 100,\n        tolerance = parameters.tolerance || 1e-10,\n        fA = f(a),\n        fB = f(b),\n        delta = b - a;\n\n    if (fA * fB > 0) {\n        throw \"Initial bisect points must have opposite signs\";\n    }\n\n    if (fA === 0) return a;\n    if (fB === 0) return b;\n\n    for (var i = 0; i < maxIterations; ++i) {\n        delta /= 2;\n        var mid = a + delta,\n            fMid = f(mid);\n\n        if (fMid * fA >= 0) {\n            a = mid;\n        }\n\n        if ((Math.abs(delta) < tolerance) || (fMid === 0)) {\n            return mid;\n        }\n    }\n    return a + delta;\n}\n","function none() {}\n\nexport default function(selector) {\n  return selector == null ? none : function() {\n    return this.querySelector(selector);\n  };\n}\n","function empty() {\n  return [];\n}\n\nexport default function(selector) {\n  return selector == null ? empty : function() {\n    return this.querySelectorAll(selector);\n  };\n}\n","export default function(selector) {\n  return function() {\n    return this.matches(selector);\n  };\n}\n","export default function(update) {\n  return new Array(update.length);\n}\n","import sparse from \"./sparse\";\nimport {Selection} from \"./index\";\n\nexport default function() {\n  return new Selection(this._enter || this._groups.map(sparse), this._parents);\n}\n\nexport function EnterNode(parent, datum) {\n  this.ownerDocument = parent.ownerDocument;\n  this.namespaceURI = parent.namespaceURI;\n  this._next = null;\n  this._parent = parent;\n  this.__data__ = datum;\n}\n\nEnterNode.prototype = {\n  constructor: EnterNode,\n  appendChild: function(child) { return this._parent.insertBefore(child, this._next); },\n  insertBefore: function(child, next) { return this._parent.insertBefore(child, next); },\n  querySelector: function(selector) { return this._parent.querySelector(selector); },\n  querySelectorAll: function(selector) { return this._parent.querySelectorAll(selector); }\n};\n","import {Selection} from \"./index\";\nimport {EnterNode} from \"./enter\";\nimport constant from \"../constant\";\n\nvar keyPrefix = \"$\"; // Protect against keys like __proto__.\n\nfunction bindIndex(parent, group, enter, update, exit, data) {\n  var i = 0,\n      node,\n      groupLength = group.length,\n      dataLength = data.length;\n\n  // Put any non-null nodes that fit into update.\n  // Put any null nodes into enter.\n  // Put any remaining data into enter.\n  for (; i < dataLength; ++i) {\n    if (node = group[i]) {\n      node.__data__ = data[i];\n      update[i] = node;\n    } else {\n      enter[i] = new EnterNode(parent, data[i]);\n    }\n  }\n\n  // Put any non-null nodes that dont fit into exit.\n  for (; i < groupLength; ++i) {\n    if (node = group[i]) {\n      exit[i] = node;\n    }\n  }\n}\n\nfunction bindKey(parent, group, enter, update, exit, data, key) {\n  var i,\n      node,\n      nodeByKeyValue = {},\n      groupLength = group.length,\n      dataLength = data.length,\n      keyValues = new Array(groupLength),\n      keyValue;\n\n  // Compute the key for each node.\n  // If multiple nodes have the same key, the duplicates are added to exit.\n  for (i = 0; i < groupLength; ++i) {\n    if (node = group[i]) {\n      keyValues[i] = keyValue = keyPrefix + key.call(node, node.__data__, i, group);\n      if (keyValue in nodeByKeyValue) {\n        exit[i] = node;\n      } else {\n        nodeByKeyValue[keyValue] = node;\n      }\n    }\n  }\n\n  // Compute the key for each datum.\n  // If there a node associated with this key, join and add it to update.\n  // If there is not (or the key is a duplicate), add it to enter.\n  for (i = 0; i < dataLength; ++i) {\n    keyValue = keyPrefix + key.call(parent, data[i], i, data);\n    if (node = nodeByKeyValue[keyValue]) {\n      update[i] = node;\n      node.__data__ = data[i];\n      nodeByKeyValue[keyValue] = null;\n    } else {\n      enter[i] = new EnterNode(parent, data[i]);\n    }\n  }\n\n  // Add any remaining nodes that were not bound to data to exit.\n  for (i = 0; i < groupLength; ++i) {\n    if ((node = group[i]) && (nodeByKeyValue[keyValues[i]] === node)) {\n      exit[i] = node;\n    }\n  }\n}\n\nexport default function(value, key) {\n  if (!value) {\n    data = new Array(this.size()), j = -1;\n    this.each(function(d) { data[++j] = d; });\n    return data;\n  }\n\n  var bind = key ? bindKey : bindIndex,\n      parents = this._parents,\n      groups = this._groups;\n\n  if (typeof value !== \"function\") value = constant(value);\n\n  for (var m = groups.length, update = new Array(m), enter = new Array(m), exit = new Array(m), j = 0; j < m; ++j) {\n    var parent = parents[j],\n        group = groups[j],\n        groupLength = group.length,\n        data = value.call(parent, parent && parent.__data__, j, parents),\n        dataLength = data.length,\n        enterGroup = enter[j] = new Array(dataLength),\n        updateGroup = update[j] = new Array(dataLength),\n        exitGroup = exit[j] = new Array(groupLength);\n\n    bind(parent, group, enterGroup, updateGroup, exitGroup, data, key);\n\n    // Now connect the enter nodes to their following update node, such that\n    // appendChild can insert the materialized enter node before this node,\n    // rather than at the end of the parent node.\n    for (var i0 = 0, i1 = 0, previous, next; i0 < dataLength; ++i0) {\n      if (previous = enterGroup[i0]) {\n        if (i0 >= i1) i1 = i0 + 1;\n        while (!(next = updateGroup[i1]) && ++i1 < dataLength);\n        previous._next = next || null;\n      }\n    }\n  }\n\n  update = new Selection(update, parents);\n  update._enter = enter;\n  update._exit = exit;\n  return update;\n}\n","import {Selection} from \"./index\";\n\nexport default function(compare) {\n  if (!compare) compare = ascending;\n\n  function compareNode(a, b) {\n    return a && b ? compare(a.__data__, b.__data__) : !a - !b;\n  }\n\n  for (var groups = this._groups, m = groups.length, sortgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, sortgroup = sortgroups[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        sortgroup[i] = node;\n      }\n    }\n    sortgroup.sort(compareNode);\n  }\n\n  return new Selection(sortgroups, this._parents).order();\n}\n\nfunction ascending(a, b) {\n  return a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n}\n","export var xhtml = \"http://www.w3.org/1999/xhtml\";\n\nexport default {\n  svg: \"http://www.w3.org/2000/svg\",\n  xhtml: xhtml,\n  xlink: \"http://www.w3.org/1999/xlink\",\n  xml: \"http://www.w3.org/XML/1998/namespace\",\n  xmlns: \"http://www.w3.org/2000/xmlns/\"\n};\n","import namespaces from \"./namespaces\";\n\nexport default function(name) {\n  var prefix = name += \"\", i = prefix.indexOf(\":\");\n  if (i >= 0 && (prefix = name.slice(0, i)) !== \"xmlns\") name = name.slice(i + 1);\n  return namespaces.hasOwnProperty(prefix) ? {space: namespaces[prefix], local: name} : name;\n}\n","import namespace from \"../namespace\";\n\nfunction attrRemove(name) {\n  return function() {\n    this.removeAttribute(name);\n  };\n}\n\nfunction attrRemoveNS(fullname) {\n  return function() {\n    this.removeAttributeNS(fullname.space, fullname.local);\n  };\n}\n\nfunction attrConstant(name, value) {\n  return function() {\n    this.setAttribute(name, value);\n  };\n}\n\nfunction attrConstantNS(fullname, value) {\n  return function() {\n    this.setAttributeNS(fullname.space, fullname.local, value);\n  };\n}\n\nfunction attrFunction(name, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.removeAttribute(name);\n    else this.setAttribute(name, v);\n  };\n}\n\nfunction attrFunctionNS(fullname, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.removeAttributeNS(fullname.space, fullname.local);\n    else this.setAttributeNS(fullname.space, fullname.local, v);\n  };\n}\n\nexport default function(name, value) {\n  var fullname = namespace(name);\n\n  if (arguments.length < 2) {\n    var node = this.node();\n    return fullname.local\n        ? node.getAttributeNS(fullname.space, fullname.local)\n        : node.getAttribute(fullname);\n  }\n\n  return this.each((value == null\n      ? (fullname.local ? attrRemoveNS : attrRemove) : (typeof value === \"function\"\n      ? (fullname.local ? attrFunctionNS : attrFunction)\n      : (fullname.local ? attrConstantNS : attrConstant)))(fullname, value));\n}\n","export default function(node) {\n  return (node.ownerDocument && node.ownerDocument.defaultView) // node is a Node\n      || (node.document && node) // node is a Window\n      || node.defaultView; // node is a Document\n}\n","import defaultView from \"../window\";\n\nfunction styleRemove(name) {\n  return function() {\n    this.style.removeProperty(name);\n  };\n}\n\nfunction styleConstant(name, value, priority) {\n  return function() {\n    this.style.setProperty(name, value, priority);\n  };\n}\n\nfunction styleFunction(name, value, priority) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.style.removeProperty(name);\n    else this.style.setProperty(name, v, priority);\n  };\n}\n\nexport default function(name, value, priority) {\n  return arguments.length > 1\n      ? this.each((value == null\n            ? styleRemove : typeof value === \"function\"\n            ? styleFunction\n            : styleConstant)(name, value, priority == null ? \"\" : priority))\n      : styleValue(this.node(), name);\n}\n\nexport function styleValue(node, name) {\n  return node.style.getPropertyValue(name)\n      || defaultView(node).getComputedStyle(node, null).getPropertyValue(name);\n}\n","function propertyRemove(name) {\n  return function() {\n    delete this[name];\n  };\n}\n\nfunction propertyConstant(name, value) {\n  return function() {\n    this[name] = value;\n  };\n}\n\nfunction propertyFunction(name, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) delete this[name];\n    else this[name] = v;\n  };\n}\n\nexport default function(name, value) {\n  return arguments.length > 1\n      ? this.each((value == null\n          ? propertyRemove : typeof value === \"function\"\n          ? propertyFunction\n          : propertyConstant)(name, value))\n      : this.node()[name];\n}\n","function classArray(string) {\n  return string.trim().split(/^|\\s+/);\n}\n\nfunction classList(node) {\n  return node.classList || new ClassList(node);\n}\n\nfunction ClassList(node) {\n  this._node = node;\n  this._names = classArray(node.getAttribute(\"class\") || \"\");\n}\n\nClassList.prototype = {\n  add: function(name) {\n    var i = this._names.indexOf(name);\n    if (i < 0) {\n      this._names.push(name);\n      this._node.setAttribute(\"class\", this._names.join(\" \"));\n    }\n  },\n  remove: function(name) {\n    var i = this._names.indexOf(name);\n    if (i >= 0) {\n      this._names.splice(i, 1);\n      this._node.setAttribute(\"class\", this._names.join(\" \"));\n    }\n  },\n  contains: function(name) {\n    return this._names.indexOf(name) >= 0;\n  }\n};\n\nfunction classedAdd(node, names) {\n  var list = classList(node), i = -1, n = names.length;\n  while (++i < n) list.add(names[i]);\n}\n\nfunction classedRemove(node, names) {\n  var list = classList(node), i = -1, n = names.length;\n  while (++i < n) list.remove(names[i]);\n}\n\nfunction classedTrue(names) {\n  return function() {\n    classedAdd(this, names);\n  };\n}\n\nfunction classedFalse(names) {\n  return function() {\n    classedRemove(this, names);\n  };\n}\n\nfunction classedFunction(names, value) {\n  return function() {\n    (value.apply(this, arguments) ? classedAdd : classedRemove)(this, names);\n  };\n}\n\nexport default function(name, value) {\n  var names = classArray(name + \"\");\n\n  if (arguments.length < 2) {\n    var list = classList(this.node()), i = -1, n = names.length;\n    while (++i < n) if (!list.contains(names[i])) return false;\n    return true;\n  }\n\n  return this.each((typeof value === \"function\"\n      ? classedFunction : value\n      ? classedTrue\n      : classedFalse)(names, value));\n}\n","function textRemove() {\n  this.textContent = \"\";\n}\n\nfunction textConstant(value) {\n  return function() {\n    this.textContent = value;\n  };\n}\n\nfunction textFunction(value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    this.textContent = v == null ? \"\" : v;\n  };\n}\n\nexport default function(value) {\n  return arguments.length\n      ? this.each(value == null\n          ? textRemove : (typeof value === \"function\"\n          ? textFunction\n          : textConstant)(value))\n      : this.node().textContent;\n}\n","function htmlRemove() {\n  this.innerHTML = \"\";\n}\n\nfunction htmlConstant(value) {\n  return function() {\n    this.innerHTML = value;\n  };\n}\n\nfunction htmlFunction(value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    this.innerHTML = v == null ? \"\" : v;\n  };\n}\n\nexport default function(value) {\n  return arguments.length\n      ? this.each(value == null\n          ? htmlRemove : (typeof value === \"function\"\n          ? htmlFunction\n          : htmlConstant)(value))\n      : this.node().innerHTML;\n}\n","function raise() {\n  if (this.nextSibling) this.parentNode.appendChild(this);\n}\n\nexport default function() {\n  return this.each(raise);\n}\n","function lower() {\n  if (this.previousSibling) this.parentNode.insertBefore(this, this.parentNode.firstChild);\n}\n\nexport default function() {\n  return this.each(lower);\n}\n","import namespace from \"./namespace\";\nimport {xhtml} from \"./namespaces\";\n\nfunction creatorInherit(name) {\n  return function() {\n    var document = this.ownerDocument,\n        uri = this.namespaceURI;\n    return uri === xhtml && document.documentElement.namespaceURI === xhtml\n        ? document.createElement(name)\n        : document.createElementNS(uri, name);\n  };\n}\n\nfunction creatorFixed(fullname) {\n  return function() {\n    return this.ownerDocument.createElementNS(fullname.space, fullname.local);\n  };\n}\n\nexport default function(name) {\n  var fullname = namespace(name);\n  return (fullname.local\n      ? creatorFixed\n      : creatorInherit)(fullname);\n}\n","import creator from \"../creator\";\nimport selector from \"../selector\";\n\nfunction constantNull() {\n  return null;\n}\n\nexport default function(name, before) {\n  var create = typeof name === \"function\" ? name : creator(name),\n      select = before == null ? constantNull : typeof before === \"function\" ? before : selector(before);\n  return this.select(function() {\n    return this.insertBefore(create.apply(this, arguments), select.apply(this, arguments) || null);\n  });\n}\n","function remove() {\n  var parent = this.parentNode;\n  if (parent) parent.removeChild(this);\n}\n\nexport default function() {\n  return this.each(remove);\n}\n","function selection_cloneShallow() {\n  var clone = this.cloneNode(false), parent = this.parentNode;\n  return parent ? parent.insertBefore(clone, this.nextSibling) : clone;\n}\n\nfunction selection_cloneDeep() {\n  var clone = this.cloneNode(true), parent = this.parentNode;\n  return parent ? parent.insertBefore(clone, this.nextSibling) : clone;\n}\n\nexport default function(deep) {\n  return this.select(deep ? selection_cloneDeep : selection_cloneShallow);\n}\n","var filterEvents = {};\n\nexport var event = null;\n\nif (typeof document !== \"undefined\") {\n  var element = document.documentElement;\n  if (!(\"onmouseenter\" in element)) {\n    filterEvents = {mouseenter: \"mouseover\", mouseleave: \"mouseout\"};\n  }\n}\n\nfunction filterContextListener(listener, index, group) {\n  listener = contextListener(listener, index, group);\n  return function(event) {\n    var related = event.relatedTarget;\n    if (!related || (related !== this && !(related.compareDocumentPosition(this) & 8))) {\n      listener.call(this, event);\n    }\n  };\n}\n\nfunction contextListener(listener, index, group) {\n  return function(event1) {\n    var event0 = event; // Events can be reentrant (e.g., focus).\n    event = event1;\n    try {\n      listener.call(this, this.__data__, index, group);\n    } finally {\n      event = event0;\n    }\n  };\n}\n\nfunction parseTypenames(typenames) {\n  return typenames.trim().split(/^|\\s+/).map(function(t) {\n    var name = \"\", i = t.indexOf(\".\");\n    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);\n    return {type: t, name: name};\n  });\n}\n\nfunction onRemove(typename) {\n  return function() {\n    var on = this.__on;\n    if (!on) return;\n    for (var j = 0, i = -1, m = on.length, o; j < m; ++j) {\n      if (o = on[j], (!typename.type || o.type === typename.type) && o.name === typename.name) {\n        this.removeEventListener(o.type, o.listener, o.capture);\n      } else {\n        on[++i] = o;\n      }\n    }\n    if (++i) on.length = i;\n    else delete this.__on;\n  };\n}\n\nfunction onAdd(typename, value, capture) {\n  var wrap = filterEvents.hasOwnProperty(typename.type) ? filterContextListener : contextListener;\n  return function(d, i, group) {\n    var on = this.__on, o, listener = wrap(value, i, group);\n    if (on) for (var j = 0, m = on.length; j < m; ++j) {\n      if ((o = on[j]).type === typename.type && o.name === typename.name) {\n        this.removeEventListener(o.type, o.listener, o.capture);\n        this.addEventListener(o.type, o.listener = listener, o.capture = capture);\n        o.value = value;\n        return;\n      }\n    }\n    this.addEventListener(typename.type, listener, capture);\n    o = {type: typename.type, name: typename.name, value: value, listener: listener, capture: capture};\n    if (!on) this.__on = [o];\n    else on.push(o);\n  };\n}\n\nexport default function(typename, value, capture) {\n  var typenames = parseTypenames(typename + \"\"), i, n = typenames.length, t;\n\n  if (arguments.length < 2) {\n    var on = this.node().__on;\n    if (on) for (var j = 0, m = on.length, o; j < m; ++j) {\n      for (i = 0, o = on[j]; i < n; ++i) {\n        if ((t = typenames[i]).type === o.type && t.name === o.name) {\n          return o.value;\n        }\n      }\n    }\n    return;\n  }\n\n  on = value ? onAdd : onRemove;\n  if (capture == null) capture = false;\n  for (i = 0; i < n; ++i) this.each(on(typenames[i], value, capture));\n  return this;\n}\n\nexport function customEvent(event1, listener, that, args) {\n  var event0 = event;\n  event1.sourceEvent = event;\n  event = event1;\n  try {\n    return listener.apply(that, args);\n  } finally {\n    event = event0;\n  }\n}\n","import defaultView from \"../window\";\n\nfunction dispatchEvent(node, type, params) {\n  var window = defaultView(node),\n      event = window.CustomEvent;\n\n  if (typeof event === \"function\") {\n    event = new event(type, params);\n  } else {\n    event = window.document.createEvent(\"Event\");\n    if (params) event.initEvent(type, params.bubbles, params.cancelable), event.detail = params.detail;\n    else event.initEvent(type, false, false);\n  }\n\n  node.dispatchEvent(event);\n}\n\nfunction dispatchConstant(type, params) {\n  return function() {\n    return dispatchEvent(this, type, params);\n  };\n}\n\nfunction dispatchFunction(type, params) {\n  return function() {\n    return dispatchEvent(this, type, params.apply(this, arguments));\n  };\n}\n\nexport default function(type, params) {\n  return this.each((typeof params === \"function\"\n      ? dispatchFunction\n      : dispatchConstant)(type, params));\n}\n","import selection_select from \"./select\";\nimport selection_selectAll from \"./selectAll\";\nimport selection_filter from \"./filter\";\nimport selection_data from \"./data\";\nimport selection_enter from \"./enter\";\nimport selection_exit from \"./exit\";\nimport selection_join from \"./join\";\nimport selection_merge from \"./merge\";\nimport selection_order from \"./order\";\nimport selection_sort from \"./sort\";\nimport selection_call from \"./call\";\nimport selection_nodes from \"./nodes\";\nimport selection_node from \"./node\";\nimport selection_size from \"./size\";\nimport selection_empty from \"./empty\";\nimport selection_each from \"./each\";\nimport selection_attr from \"./attr\";\nimport selection_style from \"./style\";\nimport selection_property from \"./property\";\nimport selection_classed from \"./classed\";\nimport selection_text from \"./text\";\nimport selection_html from \"./html\";\nimport selection_raise from \"./raise\";\nimport selection_lower from \"./lower\";\nimport selection_append from \"./append\";\nimport selection_insert from \"./insert\";\nimport selection_remove from \"./remove\";\nimport selection_clone from \"./clone\";\nimport selection_datum from \"./datum\";\nimport selection_on from \"./on\";\nimport selection_dispatch from \"./dispatch\";\n\nexport var root = [null];\n\nexport function Selection(groups, parents) {\n  this._groups = groups;\n  this._parents = parents;\n}\n\nfunction selection() {\n  return new Selection([[document.documentElement]], root);\n}\n\nSelection.prototype = selection.prototype = {\n  constructor: Selection,\n  select: selection_select,\n  selectAll: selection_selectAll,\n  filter: selection_filter,\n  data: selection_data,\n  enter: selection_enter,\n  exit: selection_exit,\n  join: selection_join,\n  merge: selection_merge,\n  order: selection_order,\n  sort: selection_sort,\n  call: selection_call,\n  nodes: selection_nodes,\n  node: selection_node,\n  size: selection_size,\n  empty: selection_empty,\n  each: selection_each,\n  attr: selection_attr,\n  style: selection_style,\n  property: selection_property,\n  classed: selection_classed,\n  text: selection_text,\n  html: selection_html,\n  raise: selection_raise,\n  lower: selection_lower,\n  append: selection_append,\n  insert: selection_insert,\n  remove: selection_remove,\n  clone: selection_clone,\n  datum: selection_datum,\n  on: selection_on,\n  dispatch: selection_dispatch\n};\n\nexport default selection;\n","import {Selection} from \"./index\";\nimport selector from \"../selector\";\n\nexport default function(select) {\n  if (typeof select !== \"function\") select = selector(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {\n      if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {\n        if (\"__data__\" in node) subnode.__data__ = node.__data__;\n        subgroup[i] = subnode;\n      }\n    }\n  }\n\n  return new Selection(subgroups, this._parents);\n}\n","import {Selection} from \"./index\";\nimport selectorAll from \"../selectorAll\";\n\nexport default function(select) {\n  if (typeof select !== \"function\") select = selectorAll(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        subgroups.push(select.call(node, node.__data__, i, group));\n        parents.push(node);\n      }\n    }\n  }\n\n  return new Selection(subgroups, parents);\n}\n","import {Selection} from \"./index\";\nimport matcher from \"../matcher\";\n\nexport default function(match) {\n  if (typeof match !== \"function\") match = matcher(match);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {\n      if ((node = group[i]) && match.call(node, node.__data__, i, group)) {\n        subgroup.push(node);\n      }\n    }\n  }\n\n  return new Selection(subgroups, this._parents);\n}\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","import sparse from \"./sparse\";\nimport {Selection} from \"./index\";\n\nexport default function() {\n  return new Selection(this._exit || this._groups.map(sparse), this._parents);\n}\n","export default function(onenter, onupdate, onexit) {\n  var enter = this.enter(), update = this, exit = this.exit();\n  enter = typeof onenter === \"function\" ? onenter(enter) : enter.append(onenter + \"\");\n  if (onupdate != null) update = onupdate(update);\n  if (onexit == null) exit.remove(); else onexit(exit);\n  return enter && update ? enter.merge(update).order() : update;\n}\n","import {Selection} from \"./index\";\n\nexport default function(selection) {\n\n  for (var groups0 = this._groups, groups1 = selection._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {\n    for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group0[i] || group1[i]) {\n        merge[i] = node;\n      }\n    }\n  }\n\n  for (; j < m0; ++j) {\n    merges[j] = groups0[j];\n  }\n\n  return new Selection(merges, this._parents);\n}\n","export default function() {\n\n  for (var groups = this._groups, j = -1, m = groups.length; ++j < m;) {\n    for (var group = groups[j], i = group.length - 1, next = group[i], node; --i >= 0;) {\n      if (node = group[i]) {\n        if (next && node.compareDocumentPosition(next) ^ 4) next.parentNode.insertBefore(node, next);\n        next = node;\n      }\n    }\n  }\n\n  return this;\n}\n","export default function() {\n  var callback = arguments[0];\n  arguments[0] = this;\n  callback.apply(null, arguments);\n  return this;\n}\n","export default function() {\n  var nodes = new Array(this.size()), i = -1;\n  this.each(function() { nodes[++i] = this; });\n  return nodes;\n}\n","export default function() {\n\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length; i < n; ++i) {\n      var node = group[i];\n      if (node) return node;\n    }\n  }\n\n  return null;\n}\n","export default function() {\n  var size = 0;\n  this.each(function() { ++size; });\n  return size;\n}\n","export default function() {\n  return !this.node();\n}\n","export default function(callback) {\n\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length, node; i < n; ++i) {\n      if (node = group[i]) callback.call(node, node.__data__, i, group);\n    }\n  }\n\n  return this;\n}\n","import creator from \"../creator\";\n\nexport default function(name) {\n  var create = typeof name === \"function\" ? name : creator(name);\n  return this.select(function() {\n    return this.appendChild(create.apply(this, arguments));\n  });\n}\n","export default function(value) {\n  return arguments.length\n      ? this.property(\"__data__\", value)\n      : this.node().__data__;\n}\n","var noop = {value: function() {}};\n\nfunction dispatch() {\n  for (var i = 0, n = arguments.length, _ = {}, t; i < n; ++i) {\n    if (!(t = arguments[i] + \"\") || (t in _) || /[\\s.]/.test(t)) throw new Error(\"illegal type: \" + t);\n    _[t] = [];\n  }\n  return new Dispatch(_);\n}\n\nfunction Dispatch(_) {\n  this._ = _;\n}\n\nfunction parseTypenames(typenames, types) {\n  return typenames.trim().split(/^|\\s+/).map(function(t) {\n    var name = \"\", i = t.indexOf(\".\");\n    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);\n    if (t && !types.hasOwnProperty(t)) throw new Error(\"unknown type: \" + t);\n    return {type: t, name: name};\n  });\n}\n\nDispatch.prototype = dispatch.prototype = {\n  constructor: Dispatch,\n  on: function(typename, callback) {\n    var _ = this._,\n        T = parseTypenames(typename + \"\", _),\n        t,\n        i = -1,\n        n = T.length;\n\n    // If no callback was specified, return the callback of the given type and name.\n    if (arguments.length < 2) {\n      while (++i < n) if ((t = (typename = T[i]).type) && (t = get(_[t], typename.name))) return t;\n      return;\n    }\n\n    // If a type was specified, set the callback for the given type and name.\n    // Otherwise, if a null callback was specified, remove callbacks of the given name.\n    if (callback != null && typeof callback !== \"function\") throw new Error(\"invalid callback: \" + callback);\n    while (++i < n) {\n      if (t = (typename = T[i]).type) _[t] = set(_[t], typename.name, callback);\n      else if (callback == null) for (t in _) _[t] = set(_[t], typename.name, null);\n    }\n\n    return this;\n  },\n  copy: function() {\n    var copy = {}, _ = this._;\n    for (var t in _) copy[t] = _[t].slice();\n    return new Dispatch(copy);\n  },\n  call: function(type, that) {\n    if ((n = arguments.length - 2) > 0) for (var args = new Array(n), i = 0, n, t; i < n; ++i) args[i] = arguments[i + 2];\n    if (!this._.hasOwnProperty(type)) throw new Error(\"unknown type: \" + type);\n    for (t = this._[type], i = 0, n = t.length; i < n; ++i) t[i].value.apply(that, args);\n  },\n  apply: function(type, that, args) {\n    if (!this._.hasOwnProperty(type)) throw new Error(\"unknown type: \" + type);\n    for (var t = this._[type], i = 0, n = t.length; i < n; ++i) t[i].value.apply(that, args);\n  }\n};\n\nfunction get(type, name) {\n  for (var i = 0, n = type.length, c; i < n; ++i) {\n    if ((c = type[i]).name === name) {\n      return c.value;\n    }\n  }\n}\n\nfunction set(type, name, callback) {\n  for (var i = 0, n = type.length; i < n; ++i) {\n    if (type[i].name === name) {\n      type[i] = noop, type = type.slice(0, i).concat(type.slice(i + 1));\n      break;\n    }\n  }\n  if (callback != null) type.push({name: name, value: callback});\n  return type;\n}\n\nexport default dispatch;\n","var frame = 0, // is an animation frame pending?\n    timeout = 0, // is a timeout pending?\n    interval = 0, // are any timers active?\n    pokeDelay = 1000, // how frequently we check for clock skew\n    taskHead,\n    taskTail,\n    clockLast = 0,\n    clockNow = 0,\n    clockSkew = 0,\n    clock = typeof performance === \"object\" && performance.now ? performance : Date,\n    setFrame = typeof window === \"object\" && window.requestAnimationFrame ? window.requestAnimationFrame.bind(window) : function(f) { setTimeout(f, 17); };\n\nexport function now() {\n  return clockNow || (setFrame(clearNow), clockNow = clock.now() + clockSkew);\n}\n\nfunction clearNow() {\n  clockNow = 0;\n}\n\nexport function Timer() {\n  this._call =\n  this._time =\n  this._next = null;\n}\n\nTimer.prototype = timer.prototype = {\n  constructor: Timer,\n  restart: function(callback, delay, time) {\n    if (typeof callback !== \"function\") throw new TypeError(\"callback is not a function\");\n    time = (time == null ? now() : +time) + (delay == null ? 0 : +delay);\n    if (!this._next && taskTail !== this) {\n      if (taskTail) taskTail._next = this;\n      else taskHead = this;\n      taskTail = this;\n    }\n    this._call = callback;\n    this._time = time;\n    sleep();\n  },\n  stop: function() {\n    if (this._call) {\n      this._call = null;\n      this._time = Infinity;\n      sleep();\n    }\n  }\n};\n\nexport function timer(callback, delay, time) {\n  var t = new Timer;\n  t.restart(callback, delay, time);\n  return t;\n}\n\nexport function timerFlush() {\n  now(); // Get the current time, if not already set.\n  ++frame; // Pretend weve set an alarm, if we havent already.\n  var t = taskHead, e;\n  while (t) {\n    if ((e = clockNow - t._time) >= 0) t._call.call(null, e);\n    t = t._next;\n  }\n  --frame;\n}\n\nfunction wake() {\n  clockNow = (clockLast = clock.now()) + clockSkew;\n  frame = timeout = 0;\n  try {\n    timerFlush();\n  } finally {\n    frame = 0;\n    nap();\n    clockNow = 0;\n  }\n}\n\nfunction poke() {\n  var now = clock.now(), delay = now - clockLast;\n  if (delay > pokeDelay) clockSkew -= delay, clockLast = now;\n}\n\nfunction nap() {\n  var t0, t1 = taskHead, t2, time = Infinity;\n  while (t1) {\n    if (t1._call) {\n      if (time > t1._time) time = t1._time;\n      t0 = t1, t1 = t1._next;\n    } else {\n      t2 = t1._next, t1._next = null;\n      t1 = t0 ? t0._next = t2 : taskHead = t2;\n    }\n  }\n  taskTail = t0;\n  sleep(time);\n}\n\nfunction sleep(time) {\n  if (frame) return; // Soonest alarm already set, or will be.\n  if (timeout) timeout = clearTimeout(timeout);\n  var delay = time - clockNow; // Strictly less than if we recomputed clockNow.\n  if (delay > 24) {\n    if (time < Infinity) timeout = setTimeout(wake, time - clock.now() - clockSkew);\n    if (interval) interval = clearInterval(interval);\n  } else {\n    if (!interval) clockLast = clock.now(), interval = setInterval(poke, pokeDelay);\n    frame = 1, setFrame(wake);\n  }\n}\n","import {Timer} from \"./timer.js\";\n\nexport default function(callback, delay, time) {\n  var t = new Timer;\n  delay = delay == null ? 0 : +delay;\n  t.restart(function(elapsed) {\n    t.stop();\n    callback(elapsed + delay);\n  }, delay, time);\n  return t;\n}\n","import {dispatch} from \"d3-dispatch\";\nimport {timer, timeout} from \"d3-timer\";\n\nvar emptyOn = dispatch(\"start\", \"end\", \"cancel\", \"interrupt\");\nvar emptyTween = [];\n\nexport var CREATED = 0;\nexport var SCHEDULED = 1;\nexport var STARTING = 2;\nexport var STARTED = 3;\nexport var RUNNING = 4;\nexport var ENDING = 5;\nexport var ENDED = 6;\n\nexport default function(node, name, id, index, group, timing) {\n  var schedules = node.__transition;\n  if (!schedules) node.__transition = {};\n  else if (id in schedules) return;\n  create(node, id, {\n    name: name,\n    index: index, // For context during callback.\n    group: group, // For context during callback.\n    on: emptyOn,\n    tween: emptyTween,\n    time: timing.time,\n    delay: timing.delay,\n    duration: timing.duration,\n    ease: timing.ease,\n    timer: null,\n    state: CREATED\n  });\n}\n\nexport function init(node, id) {\n  var schedule = get(node, id);\n  if (schedule.state > CREATED) throw new Error(\"too late; already scheduled\");\n  return schedule;\n}\n\nexport function set(node, id) {\n  var schedule = get(node, id);\n  if (schedule.state > STARTED) throw new Error(\"too late; already running\");\n  return schedule;\n}\n\nexport function get(node, id) {\n  var schedule = node.__transition;\n  if (!schedule || !(schedule = schedule[id])) throw new Error(\"transition not found\");\n  return schedule;\n}\n\nfunction create(node, id, self) {\n  var schedules = node.__transition,\n      tween;\n\n  // Initialize the self timer when the transition is created.\n  // Note the actual delay is not known until the first callback!\n  schedules[id] = self;\n  self.timer = timer(schedule, 0, self.time);\n\n  function schedule(elapsed) {\n    self.state = SCHEDULED;\n    self.timer.restart(start, self.delay, self.time);\n\n    // If the elapsed delay is less than our first sleep, start immediately.\n    if (self.delay <= elapsed) start(elapsed - self.delay);\n  }\n\n  function start(elapsed) {\n    var i, j, n, o;\n\n    // If the state is not SCHEDULED, then we previously errored on start.\n    if (self.state !== SCHEDULED) return stop();\n\n    for (i in schedules) {\n      o = schedules[i];\n      if (o.name !== self.name) continue;\n\n      // While this element already has a starting transition during this frame,\n      // defer starting an interrupting transition until that transition has a\n      // chance to tick (and possibly end); see d3/d3-transition#54!\n      if (o.state === STARTED) return timeout(start);\n\n      // Interrupt the active transition, if any.\n      if (o.state === RUNNING) {\n        o.state = ENDED;\n        o.timer.stop();\n        o.on.call(\"interrupt\", node, node.__data__, o.index, o.group);\n        delete schedules[i];\n      }\n\n      // Cancel any pre-empted transitions.\n      else if (+i < id) {\n        o.state = ENDED;\n        o.timer.stop();\n        o.on.call(\"cancel\", node, node.__data__, o.index, o.group);\n        delete schedules[i];\n      }\n    }\n\n    // Defer the first tick to end of the current frame; see d3/d3#1576.\n    // Note the transition may be canceled after start and before the first tick!\n    // Note this must be scheduled before the start event; see d3/d3-transition#16!\n    // Assuming this is successful, subsequent callbacks go straight to tick.\n    timeout(function() {\n      if (self.state === STARTED) {\n        self.state = RUNNING;\n        self.timer.restart(tick, self.delay, self.time);\n        tick(elapsed);\n      }\n    });\n\n    // Dispatch the start event.\n    // Note this must be done before the tween are initialized.\n    self.state = STARTING;\n    self.on.call(\"start\", node, node.__data__, self.index, self.group);\n    if (self.state !== STARTING) return; // interrupted\n    self.state = STARTED;\n\n    // Initialize the tween, deleting null tween.\n    tween = new Array(n = self.tween.length);\n    for (i = 0, j = -1; i < n; ++i) {\n      if (o = self.tween[i].value.call(node, node.__data__, self.index, self.group)) {\n        tween[++j] = o;\n      }\n    }\n    tween.length = j + 1;\n  }\n\n  function tick(elapsed) {\n    var t = elapsed < self.duration ? self.ease.call(null, elapsed / self.duration) : (self.timer.restart(stop), self.state = ENDING, 1),\n        i = -1,\n        n = tween.length;\n\n    while (++i < n) {\n      tween[i].call(node, t);\n    }\n\n    // Dispatch the end event.\n    if (self.state === ENDING) {\n      self.on.call(\"end\", node, node.__data__, self.index, self.group);\n      stop();\n    }\n  }\n\n  function stop() {\n    self.state = ENDED;\n    self.timer.stop();\n    delete schedules[id];\n    for (var i in schedules) return; // eslint-disable-line no-unused-vars\n    delete node.__transition;\n  }\n}\n","export default function(a, b) {\n  return a = +a, b = +b, function(t) {\n    return a * (1 - t) + b * t;\n  };\n}\n","var degrees = 180 / Math.PI;\n\nexport var identity = {\n  translateX: 0,\n  translateY: 0,\n  rotate: 0,\n  skewX: 0,\n  scaleX: 1,\n  scaleY: 1\n};\n\nexport default function(a, b, c, d, e, f) {\n  var scaleX, scaleY, skewX;\n  if (scaleX = Math.sqrt(a * a + b * b)) a /= scaleX, b /= scaleX;\n  if (skewX = a * c + b * d) c -= a * skewX, d -= b * skewX;\n  if (scaleY = Math.sqrt(c * c + d * d)) c /= scaleY, d /= scaleY, skewX /= scaleY;\n  if (a * d < b * c) a = -a, b = -b, skewX = -skewX, scaleX = -scaleX;\n  return {\n    translateX: e,\n    translateY: f,\n    rotate: Math.atan2(b, a) * degrees,\n    skewX: Math.atan(skewX) * degrees,\n    scaleX: scaleX,\n    scaleY: scaleY\n  };\n}\n","import decompose, {identity} from \"./decompose.js\";\n\nvar cssNode,\n    cssRoot,\n    cssView,\n    svgNode;\n\nexport function parseCss(value) {\n  if (value === \"none\") return identity;\n  if (!cssNode) cssNode = document.createElement(\"DIV\"), cssRoot = document.documentElement, cssView = document.defaultView;\n  cssNode.style.transform = value;\n  value = cssView.getComputedStyle(cssRoot.appendChild(cssNode), null).getPropertyValue(\"transform\");\n  cssRoot.removeChild(cssNode);\n  value = value.slice(7, -1).split(\",\");\n  return decompose(+value[0], +value[1], +value[2], +value[3], +value[4], +value[5]);\n}\n\nexport function parseSvg(value) {\n  if (value == null) return identity;\n  if (!svgNode) svgNode = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\n  svgNode.setAttribute(\"transform\", value);\n  if (!(value = svgNode.transform.baseVal.consolidate())) return identity;\n  value = value.matrix;\n  return decompose(value.a, value.b, value.c, value.d, value.e, value.f);\n}\n","import number from \"../number.js\";\nimport {parseCss, parseSvg} from \"./parse.js\";\n\nfunction interpolateTransform(parse, pxComma, pxParen, degParen) {\n\n  function pop(s) {\n    return s.length ? s.pop() + \" \" : \"\";\n  }\n\n  function translate(xa, ya, xb, yb, s, q) {\n    if (xa !== xb || ya !== yb) {\n      var i = s.push(\"translate(\", null, pxComma, null, pxParen);\n      q.push({i: i - 4, x: number(xa, xb)}, {i: i - 2, x: number(ya, yb)});\n    } else if (xb || yb) {\n      s.push(\"translate(\" + xb + pxComma + yb + pxParen);\n    }\n  }\n\n  function rotate(a, b, s, q) {\n    if (a !== b) {\n      if (a - b > 180) b += 360; else if (b - a > 180) a += 360; // shortest path\n      q.push({i: s.push(pop(s) + \"rotate(\", null, degParen) - 2, x: number(a, b)});\n    } else if (b) {\n      s.push(pop(s) + \"rotate(\" + b + degParen);\n    }\n  }\n\n  function skewX(a, b, s, q) {\n    if (a !== b) {\n      q.push({i: s.push(pop(s) + \"skewX(\", null, degParen) - 2, x: number(a, b)});\n    } else if (b) {\n      s.push(pop(s) + \"skewX(\" + b + degParen);\n    }\n  }\n\n  function scale(xa, ya, xb, yb, s, q) {\n    if (xa !== xb || ya !== yb) {\n      var i = s.push(pop(s) + \"scale(\", null, \",\", null, \")\");\n      q.push({i: i - 4, x: number(xa, xb)}, {i: i - 2, x: number(ya, yb)});\n    } else if (xb !== 1 || yb !== 1) {\n      s.push(pop(s) + \"scale(\" + xb + \",\" + yb + \")\");\n    }\n  }\n\n  return function(a, b) {\n    var s = [], // string constants and placeholders\n        q = []; // number interpolators\n    a = parse(a), b = parse(b);\n    translate(a.translateX, a.translateY, b.translateX, b.translateY, s, q);\n    rotate(a.rotate, b.rotate, s, q);\n    skewX(a.skewX, b.skewX, s, q);\n    scale(a.scaleX, a.scaleY, b.scaleX, b.scaleY, s, q);\n    a = b = null; // gc\n    return function(t) {\n      var i = -1, n = q.length, o;\n      while (++i < n) s[(o = q[i]).i] = o.x(t);\n      return s.join(\"\");\n    };\n  };\n}\n\nexport var interpolateTransformCss = interpolateTransform(parseCss, \"px, \", \"px)\", \"deg)\");\nexport var interpolateTransformSvg = interpolateTransform(parseSvg, \", \", \")\", \")\");\n","import {get, set} from \"./schedule.js\";\n\nfunction tweenRemove(id, name) {\n  var tween0, tween1;\n  return function() {\n    var schedule = set(this, id),\n        tween = schedule.tween;\n\n    // If this node shared tween with the previous node,\n    // just assign the updated shared tween and were done!\n    // Otherwise, copy-on-write.\n    if (tween !== tween0) {\n      tween1 = tween0 = tween;\n      for (var i = 0, n = tween1.length; i < n; ++i) {\n        if (tween1[i].name === name) {\n          tween1 = tween1.slice();\n          tween1.splice(i, 1);\n          break;\n        }\n      }\n    }\n\n    schedule.tween = tween1;\n  };\n}\n\nfunction tweenFunction(id, name, value) {\n  var tween0, tween1;\n  if (typeof value !== \"function\") throw new Error;\n  return function() {\n    var schedule = set(this, id),\n        tween = schedule.tween;\n\n    // If this node shared tween with the previous node,\n    // just assign the updated shared tween and were done!\n    // Otherwise, copy-on-write.\n    if (tween !== tween0) {\n      tween1 = (tween0 = tween).slice();\n      for (var t = {name: name, value: value}, i = 0, n = tween1.length; i < n; ++i) {\n        if (tween1[i].name === name) {\n          tween1[i] = t;\n          break;\n        }\n      }\n      if (i === n) tween1.push(t);\n    }\n\n    schedule.tween = tween1;\n  };\n}\n\nexport default function(name, value) {\n  var id = this._id;\n\n  name += \"\";\n\n  if (arguments.length < 2) {\n    var tween = get(this.node(), id).tween;\n    for (var i = 0, n = tween.length, t; i < n; ++i) {\n      if ((t = tween[i]).name === name) {\n        return t.value;\n      }\n    }\n    return null;\n  }\n\n  return this.each((value == null ? tweenRemove : tweenFunction)(id, name, value));\n}\n\nexport function tweenValue(transition, name, value) {\n  var id = transition._id;\n\n  transition.each(function() {\n    var schedule = set(this, id);\n    (schedule.value || (schedule.value = {}))[name] = value.apply(this, arguments);\n  });\n\n  return function(node) {\n    return get(node, id).value[name];\n  };\n}\n","export default function(constructor, factory, prototype) {\n  constructor.prototype = factory.prototype = prototype;\n  prototype.constructor = constructor;\n}\n\nexport function extend(parent, definition) {\n  var prototype = Object.create(parent.prototype);\n  for (var key in definition) prototype[key] = definition[key];\n  return prototype;\n}\n","import define, {extend} from \"./define.js\";\n\nexport function Color() {}\n\nexport var darker = 0.7;\nexport var brighter = 1 / darker;\n\nvar reI = \"\\\\s*([+-]?\\\\d+)\\\\s*\",\n    reN = \"\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*\",\n    reP = \"\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*\",\n    reHex = /^#([0-9a-f]{3,8})$/,\n    reRgbInteger = new RegExp(\"^rgb\\\\(\" + [reI, reI, reI] + \"\\\\)$\"),\n    reRgbPercent = new RegExp(\"^rgb\\\\(\" + [reP, reP, reP] + \"\\\\)$\"),\n    reRgbaInteger = new RegExp(\"^rgba\\\\(\" + [reI, reI, reI, reN] + \"\\\\)$\"),\n    reRgbaPercent = new RegExp(\"^rgba\\\\(\" + [reP, reP, reP, reN] + \"\\\\)$\"),\n    reHslPercent = new RegExp(\"^hsl\\\\(\" + [reN, reP, reP] + \"\\\\)$\"),\n    reHslaPercent = new RegExp(\"^hsla\\\\(\" + [reN, reP, reP, reN] + \"\\\\)$\");\n\nvar named = {\n  aliceblue: 0xf0f8ff,\n  antiquewhite: 0xfaebd7,\n  aqua: 0x00ffff,\n  aquamarine: 0x7fffd4,\n  azure: 0xf0ffff,\n  beige: 0xf5f5dc,\n  bisque: 0xffe4c4,\n  black: 0x000000,\n  blanchedalmond: 0xffebcd,\n  blue: 0x0000ff,\n  blueviolet: 0x8a2be2,\n  brown: 0xa52a2a,\n  burlywood: 0xdeb887,\n  cadetblue: 0x5f9ea0,\n  chartreuse: 0x7fff00,\n  chocolate: 0xd2691e,\n  coral: 0xff7f50,\n  cornflowerblue: 0x6495ed,\n  cornsilk: 0xfff8dc,\n  crimson: 0xdc143c,\n  cyan: 0x00ffff,\n  darkblue: 0x00008b,\n  darkcyan: 0x008b8b,\n  darkgoldenrod: 0xb8860b,\n  darkgray: 0xa9a9a9,\n  darkgreen: 0x006400,\n  darkgrey: 0xa9a9a9,\n  darkkhaki: 0xbdb76b,\n  darkmagenta: 0x8b008b,\n  darkolivegreen: 0x556b2f,\n  darkorange: 0xff8c00,\n  darkorchid: 0x9932cc,\n  darkred: 0x8b0000,\n  darksalmon: 0xe9967a,\n  darkseagreen: 0x8fbc8f,\n  darkslateblue: 0x483d8b,\n  darkslategray: 0x2f4f4f,\n  darkslategrey: 0x2f4f4f,\n  darkturquoise: 0x00ced1,\n  darkviolet: 0x9400d3,\n  deeppink: 0xff1493,\n  deepskyblue: 0x00bfff,\n  dimgray: 0x696969,\n  dimgrey: 0x696969,\n  dodgerblue: 0x1e90ff,\n  firebrick: 0xb22222,\n  floralwhite: 0xfffaf0,\n  forestgreen: 0x228b22,\n  fuchsia: 0xff00ff,\n  gainsboro: 0xdcdcdc,\n  ghostwhite: 0xf8f8ff,\n  gold: 0xffd700,\n  goldenrod: 0xdaa520,\n  gray: 0x808080,\n  green: 0x008000,\n  greenyellow: 0xadff2f,\n  grey: 0x808080,\n  honeydew: 0xf0fff0,\n  hotpink: 0xff69b4,\n  indianred: 0xcd5c5c,\n  indigo: 0x4b0082,\n  ivory: 0xfffff0,\n  khaki: 0xf0e68c,\n  lavender: 0xe6e6fa,\n  lavenderblush: 0xfff0f5,\n  lawngreen: 0x7cfc00,\n  lemonchiffon: 0xfffacd,\n  lightblue: 0xadd8e6,\n  lightcoral: 0xf08080,\n  lightcyan: 0xe0ffff,\n  lightgoldenrodyellow: 0xfafad2,\n  lightgray: 0xd3d3d3,\n  lightgreen: 0x90ee90,\n  lightgrey: 0xd3d3d3,\n  lightpink: 0xffb6c1,\n  lightsalmon: 0xffa07a,\n  lightseagreen: 0x20b2aa,\n  lightskyblue: 0x87cefa,\n  lightslategray: 0x778899,\n  lightslategrey: 0x778899,\n  lightsteelblue: 0xb0c4de,\n  lightyellow: 0xffffe0,\n  lime: 0x00ff00,\n  limegreen: 0x32cd32,\n  linen: 0xfaf0e6,\n  magenta: 0xff00ff,\n  maroon: 0x800000,\n  mediumaquamarine: 0x66cdaa,\n  mediumblue: 0x0000cd,\n  mediumorchid: 0xba55d3,\n  mediumpurple: 0x9370db,\n  mediumseagreen: 0x3cb371,\n  mediumslateblue: 0x7b68ee,\n  mediumspringgreen: 0x00fa9a,\n  mediumturquoise: 0x48d1cc,\n  mediumvioletred: 0xc71585,\n  midnightblue: 0x191970,\n  mintcream: 0xf5fffa,\n  mistyrose: 0xffe4e1,\n  moccasin: 0xffe4b5,\n  navajowhite: 0xffdead,\n  navy: 0x000080,\n  oldlace: 0xfdf5e6,\n  olive: 0x808000,\n  olivedrab: 0x6b8e23,\n  orange: 0xffa500,\n  orangered: 0xff4500,\n  orchid: 0xda70d6,\n  palegoldenrod: 0xeee8aa,\n  palegreen: 0x98fb98,\n  paleturquoise: 0xafeeee,\n  palevioletred: 0xdb7093,\n  papayawhip: 0xffefd5,\n  peachpuff: 0xffdab9,\n  peru: 0xcd853f,\n  pink: 0xffc0cb,\n  plum: 0xdda0dd,\n  powderblue: 0xb0e0e6,\n  purple: 0x800080,\n  rebeccapurple: 0x663399,\n  red: 0xff0000,\n  rosybrown: 0xbc8f8f,\n  royalblue: 0x4169e1,\n  saddlebrown: 0x8b4513,\n  salmon: 0xfa8072,\n  sandybrown: 0xf4a460,\n  seagreen: 0x2e8b57,\n  seashell: 0xfff5ee,\n  sienna: 0xa0522d,\n  silver: 0xc0c0c0,\n  skyblue: 0x87ceeb,\n  slateblue: 0x6a5acd,\n  slategray: 0x708090,\n  slategrey: 0x708090,\n  snow: 0xfffafa,\n  springgreen: 0x00ff7f,\n  steelblue: 0x4682b4,\n  tan: 0xd2b48c,\n  teal: 0x008080,\n  thistle: 0xd8bfd8,\n  tomato: 0xff6347,\n  turquoise: 0x40e0d0,\n  violet: 0xee82ee,\n  wheat: 0xf5deb3,\n  white: 0xffffff,\n  whitesmoke: 0xf5f5f5,\n  yellow: 0xffff00,\n  yellowgreen: 0x9acd32\n};\n\ndefine(Color, color, {\n  copy: function(channels) {\n    return Object.assign(new this.constructor, this, channels);\n  },\n  displayable: function() {\n    return this.rgb().displayable();\n  },\n  hex: color_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: color_formatHex,\n  formatHsl: color_formatHsl,\n  formatRgb: color_formatRgb,\n  toString: color_formatRgb\n});\n\nfunction color_formatHex() {\n  return this.rgb().formatHex();\n}\n\nfunction color_formatHsl() {\n  return hslConvert(this).formatHsl();\n}\n\nfunction color_formatRgb() {\n  return this.rgb().formatRgb();\n}\n\nexport default function color(format) {\n  var m, l;\n  format = (format + \"\").trim().toLowerCase();\n  return (m = reHex.exec(format)) ? (l = m[1].length, m = parseInt(m[1], 16), l === 6 ? rgbn(m) // #ff0000\n      : l === 3 ? new Rgb((m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), ((m & 0xf) << 4) | (m & 0xf), 1) // #f00\n      : l === 8 ? rgba(m >> 24 & 0xff, m >> 16 & 0xff, m >> 8 & 0xff, (m & 0xff) / 0xff) // #ff000000\n      : l === 4 ? rgba((m >> 12 & 0xf) | (m >> 8 & 0xf0), (m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), (((m & 0xf) << 4) | (m & 0xf)) / 0xff) // #f000\n      : null) // invalid hex\n      : (m = reRgbInteger.exec(format)) ? new Rgb(m[1], m[2], m[3], 1) // rgb(255, 0, 0)\n      : (m = reRgbPercent.exec(format)) ? new Rgb(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, 1) // rgb(100%, 0%, 0%)\n      : (m = reRgbaInteger.exec(format)) ? rgba(m[1], m[2], m[3], m[4]) // rgba(255, 0, 0, 1)\n      : (m = reRgbaPercent.exec(format)) ? rgba(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, m[4]) // rgb(100%, 0%, 0%, 1)\n      : (m = reHslPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, 1) // hsl(120, 50%, 50%)\n      : (m = reHslaPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, m[4]) // hsla(120, 50%, 50%, 1)\n      : named.hasOwnProperty(format) ? rgbn(named[format]) // eslint-disable-line no-prototype-builtins\n      : format === \"transparent\" ? new Rgb(NaN, NaN, NaN, 0)\n      : null;\n}\n\nfunction rgbn(n) {\n  return new Rgb(n >> 16 & 0xff, n >> 8 & 0xff, n & 0xff, 1);\n}\n\nfunction rgba(r, g, b, a) {\n  if (a <= 0) r = g = b = NaN;\n  return new Rgb(r, g, b, a);\n}\n\nexport function rgbConvert(o) {\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Rgb;\n  o = o.rgb();\n  return new Rgb(o.r, o.g, o.b, o.opacity);\n}\n\nexport function rgb(r, g, b, opacity) {\n  return arguments.length === 1 ? rgbConvert(r) : new Rgb(r, g, b, opacity == null ? 1 : opacity);\n}\n\nexport function Rgb(r, g, b, opacity) {\n  this.r = +r;\n  this.g = +g;\n  this.b = +b;\n  this.opacity = +opacity;\n}\n\ndefine(Rgb, rgb, extend(Color, {\n  brighter: function(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  darker: function(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  rgb: function() {\n    return this;\n  },\n  displayable: function() {\n    return (-0.5 <= this.r && this.r < 255.5)\n        && (-0.5 <= this.g && this.g < 255.5)\n        && (-0.5 <= this.b && this.b < 255.5)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  hex: rgb_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: rgb_formatHex,\n  formatRgb: rgb_formatRgb,\n  toString: rgb_formatRgb\n}));\n\nfunction rgb_formatHex() {\n  return \"#\" + hex(this.r) + hex(this.g) + hex(this.b);\n}\n\nfunction rgb_formatRgb() {\n  var a = this.opacity; a = isNaN(a) ? 1 : Math.max(0, Math.min(1, a));\n  return (a === 1 ? \"rgb(\" : \"rgba(\")\n      + Math.max(0, Math.min(255, Math.round(this.r) || 0)) + \", \"\n      + Math.max(0, Math.min(255, Math.round(this.g) || 0)) + \", \"\n      + Math.max(0, Math.min(255, Math.round(this.b) || 0))\n      + (a === 1 ? \")\" : \", \" + a + \")\");\n}\n\nfunction hex(value) {\n  value = Math.max(0, Math.min(255, Math.round(value) || 0));\n  return (value < 16 ? \"0\" : \"\") + value.toString(16);\n}\n\nfunction hsla(h, s, l, a) {\n  if (a <= 0) h = s = l = NaN;\n  else if (l <= 0 || l >= 1) h = s = NaN;\n  else if (s <= 0) h = NaN;\n  return new Hsl(h, s, l, a);\n}\n\nexport function hslConvert(o) {\n  if (o instanceof Hsl) return new Hsl(o.h, o.s, o.l, o.opacity);\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Hsl;\n  if (o instanceof Hsl) return o;\n  o = o.rgb();\n  var r = o.r / 255,\n      g = o.g / 255,\n      b = o.b / 255,\n      min = Math.min(r, g, b),\n      max = Math.max(r, g, b),\n      h = NaN,\n      s = max - min,\n      l = (max + min) / 2;\n  if (s) {\n    if (r === max) h = (g - b) / s + (g < b) * 6;\n    else if (g === max) h = (b - r) / s + 2;\n    else h = (r - g) / s + 4;\n    s /= l < 0.5 ? max + min : 2 - max - min;\n    h *= 60;\n  } else {\n    s = l > 0 && l < 1 ? 0 : h;\n  }\n  return new Hsl(h, s, l, o.opacity);\n}\n\nexport function hsl(h, s, l, opacity) {\n  return arguments.length === 1 ? hslConvert(h) : new Hsl(h, s, l, opacity == null ? 1 : opacity);\n}\n\nfunction Hsl(h, s, l, opacity) {\n  this.h = +h;\n  this.s = +s;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\ndefine(Hsl, hsl, extend(Color, {\n  brighter: function(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  darker: function(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  rgb: function() {\n    var h = this.h % 360 + (this.h < 0) * 360,\n        s = isNaN(h) || isNaN(this.s) ? 0 : this.s,\n        l = this.l,\n        m2 = l + (l < 0.5 ? l : 1 - l) * s,\n        m1 = 2 * l - m2;\n    return new Rgb(\n      hsl2rgb(h >= 240 ? h - 240 : h + 120, m1, m2),\n      hsl2rgb(h, m1, m2),\n      hsl2rgb(h < 120 ? h + 240 : h - 120, m1, m2),\n      this.opacity\n    );\n  },\n  displayable: function() {\n    return (0 <= this.s && this.s <= 1 || isNaN(this.s))\n        && (0 <= this.l && this.l <= 1)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  formatHsl: function() {\n    var a = this.opacity; a = isNaN(a) ? 1 : Math.max(0, Math.min(1, a));\n    return (a === 1 ? \"hsl(\" : \"hsla(\")\n        + (this.h || 0) + \", \"\n        + (this.s || 0) * 100 + \"%, \"\n        + (this.l || 0) * 100 + \"%\"\n        + (a === 1 ? \")\" : \", \" + a + \")\");\n  }\n}));\n\n/* From FvD 13.37, CSS Color Module Level 3 */\nfunction hsl2rgb(h, m1, m2) {\n  return (h < 60 ? m1 + (m2 - m1) * h / 60\n      : h < 180 ? m2\n      : h < 240 ? m1 + (m2 - m1) * (240 - h) / 60\n      : m1) * 255;\n}\n","export function basis(t1, v0, v1, v2, v3) {\n  var t2 = t1 * t1, t3 = t2 * t1;\n  return ((1 - 3 * t1 + 3 * t2 - t3) * v0\n      + (4 - 6 * t2 + 3 * t3) * v1\n      + (1 + 3 * t1 + 3 * t2 - 3 * t3) * v2\n      + t3 * v3) / 6;\n}\n\nexport default function(values) {\n  var n = values.length - 1;\n  return function(t) {\n    var i = t <= 0 ? (t = 0) : t >= 1 ? (t = 1, n - 1) : Math.floor(t * n),\n        v1 = values[i],\n        v2 = values[i + 1],\n        v0 = i > 0 ? values[i - 1] : 2 * v1 - v2,\n        v3 = i < n - 1 ? values[i + 2] : 2 * v2 - v1;\n    return basis((t - i / n) * n, v0, v1, v2, v3);\n  };\n}\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","import constant from \"./constant.js\";\n\nfunction linear(a, d) {\n  return function(t) {\n    return a + t * d;\n  };\n}\n\nfunction exponential(a, b, y) {\n  return a = Math.pow(a, y), b = Math.pow(b, y) - a, y = 1 / y, function(t) {\n    return Math.pow(a + t * b, y);\n  };\n}\n\nexport function hue(a, b) {\n  var d = b - a;\n  return d ? linear(a, d > 180 || d < -180 ? d - 360 * Math.round(d / 360) : d) : constant(isNaN(a) ? b : a);\n}\n\nexport function gamma(y) {\n  return (y = +y) === 1 ? nogamma : function(a, b) {\n    return b - a ? exponential(a, b, y) : constant(isNaN(a) ? b : a);\n  };\n}\n\nexport default function nogamma(a, b) {\n  var d = b - a;\n  return d ? linear(a, d) : constant(isNaN(a) ? b : a);\n}\n","import {rgb as colorRgb} from \"d3-color\";\nimport basis from \"./basis.js\";\nimport basisClosed from \"./basisClosed.js\";\nimport nogamma, {gamma} from \"./color.js\";\n\nexport default (function rgbGamma(y) {\n  var color = gamma(y);\n\n  function rgb(start, end) {\n    var r = color((start = colorRgb(start)).r, (end = colorRgb(end)).r),\n        g = color(start.g, end.g),\n        b = color(start.b, end.b),\n        opacity = nogamma(start.opacity, end.opacity);\n    return function(t) {\n      start.r = r(t);\n      start.g = g(t);\n      start.b = b(t);\n      start.opacity = opacity(t);\n      return start + \"\";\n    };\n  }\n\n  rgb.gamma = rgbGamma;\n\n  return rgb;\n})(1);\n\nfunction rgbSpline(spline) {\n  return function(colors) {\n    var n = colors.length,\n        r = new Array(n),\n        g = new Array(n),\n        b = new Array(n),\n        i, color;\n    for (i = 0; i < n; ++i) {\n      color = colorRgb(colors[i]);\n      r[i] = color.r || 0;\n      g[i] = color.g || 0;\n      b[i] = color.b || 0;\n    }\n    r = spline(r);\n    g = spline(g);\n    b = spline(b);\n    color.opacity = 1;\n    return function(t) {\n      color.r = r(t);\n      color.g = g(t);\n      color.b = b(t);\n      return color + \"\";\n    };\n  };\n}\n\nexport var rgbBasis = rgbSpline(basis);\nexport var rgbBasisClosed = rgbSpline(basisClosed);\n","import {basis} from \"./basis.js\";\n\nexport default function(values) {\n  var n = values.length;\n  return function(t) {\n    var i = Math.floor(((t %= 1) < 0 ? ++t : t) * n),\n        v0 = values[(i + n - 1) % n],\n        v1 = values[i % n],\n        v2 = values[(i + 1) % n],\n        v3 = values[(i + 2) % n];\n    return basis((t - i / n) * n, v0, v1, v2, v3);\n  };\n}\n","import number from \"./number.js\";\n\nvar reA = /[-+]?(?:\\d+\\.?\\d*|\\.?\\d+)(?:[eE][-+]?\\d+)?/g,\n    reB = new RegExp(reA.source, \"g\");\n\nfunction zero(b) {\n  return function() {\n    return b;\n  };\n}\n\nfunction one(b) {\n  return function(t) {\n    return b(t) + \"\";\n  };\n}\n\nexport default function(a, b) {\n  var bi = reA.lastIndex = reB.lastIndex = 0, // scan index for next number in b\n      am, // current match in a\n      bm, // current match in b\n      bs, // string preceding current number in b, if any\n      i = -1, // index in s\n      s = [], // string constants and placeholders\n      q = []; // number interpolators\n\n  // Coerce inputs to strings.\n  a = a + \"\", b = b + \"\";\n\n  // Interpolate pairs of numbers in a & b.\n  while ((am = reA.exec(a))\n      && (bm = reB.exec(b))) {\n    if ((bs = bm.index) > bi) { // a string precedes the next number in b\n      bs = b.slice(bi, bs);\n      if (s[i]) s[i] += bs; // coalesce with previous string\n      else s[++i] = bs;\n    }\n    if ((am = am[0]) === (bm = bm[0])) { // numbers in a & b match\n      if (s[i]) s[i] += bm; // coalesce with previous string\n      else s[++i] = bm;\n    } else { // interpolate non-matching numbers\n      s[++i] = null;\n      q.push({i: i, x: number(am, bm)});\n    }\n    bi = reB.lastIndex;\n  }\n\n  // Add remains of b.\n  if (bi < b.length) {\n    bs = b.slice(bi);\n    if (s[i]) s[i] += bs; // coalesce with previous string\n    else s[++i] = bs;\n  }\n\n  // Special optimization for only a single match.\n  // Otherwise, interpolate each of the numbers and rejoin the string.\n  return s.length < 2 ? (q[0]\n      ? one(q[0].x)\n      : zero(b))\n      : (b = q.length, function(t) {\n          for (var i = 0, o; i < b; ++i) s[(o = q[i]).i] = o.x(t);\n          return s.join(\"\");\n        });\n}\n","import {color} from \"d3-color\";\nimport {interpolateNumber, interpolateRgb, interpolateString} from \"d3-interpolate\";\n\nexport default function(a, b) {\n  var c;\n  return (typeof b === \"number\" ? interpolateNumber\n      : b instanceof color ? interpolateRgb\n      : (c = color(b)) ? (b = c, interpolateRgb)\n      : interpolateString)(a, b);\n}\n","import {interpolateTransformSvg as interpolateTransform} from \"d3-interpolate\";\nimport {namespace} from \"d3-selection\";\nimport {tweenValue} from \"./tween.js\";\nimport interpolate from \"./interpolate.js\";\n\nfunction attrRemove(name) {\n  return function() {\n    this.removeAttribute(name);\n  };\n}\n\nfunction attrRemoveNS(fullname) {\n  return function() {\n    this.removeAttributeNS(fullname.space, fullname.local);\n  };\n}\n\nfunction attrConstant(name, interpolate, value1) {\n  var string00,\n      string1 = value1 + \"\",\n      interpolate0;\n  return function() {\n    var string0 = this.getAttribute(name);\n    return string0 === string1 ? null\n        : string0 === string00 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, value1);\n  };\n}\n\nfunction attrConstantNS(fullname, interpolate, value1) {\n  var string00,\n      string1 = value1 + \"\",\n      interpolate0;\n  return function() {\n    var string0 = this.getAttributeNS(fullname.space, fullname.local);\n    return string0 === string1 ? null\n        : string0 === string00 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, value1);\n  };\n}\n\nfunction attrFunction(name, interpolate, value) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0, value1 = value(this), string1;\n    if (value1 == null) return void this.removeAttribute(name);\n    string0 = this.getAttribute(name);\n    string1 = value1 + \"\";\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));\n  };\n}\n\nfunction attrFunctionNS(fullname, interpolate, value) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0, value1 = value(this), string1;\n    if (value1 == null) return void this.removeAttributeNS(fullname.space, fullname.local);\n    string0 = this.getAttributeNS(fullname.space, fullname.local);\n    string1 = value1 + \"\";\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));\n  };\n}\n\nexport default function(name, value) {\n  var fullname = namespace(name), i = fullname === \"transform\" ? interpolateTransform : interpolate;\n  return this.attrTween(name, typeof value === \"function\"\n      ? (fullname.local ? attrFunctionNS : attrFunction)(fullname, i, tweenValue(this, \"attr.\" + name, value))\n      : value == null ? (fullname.local ? attrRemoveNS : attrRemove)(fullname)\n      : (fullname.local ? attrConstantNS : attrConstant)(fullname, i, value));\n}\n","import {namespace} from \"d3-selection\";\n\nfunction attrInterpolate(name, i) {\n  return function(t) {\n    this.setAttribute(name, i.call(this, t));\n  };\n}\n\nfunction attrInterpolateNS(fullname, i) {\n  return function(t) {\n    this.setAttributeNS(fullname.space, fullname.local, i.call(this, t));\n  };\n}\n\nfunction attrTweenNS(fullname, value) {\n  var t0, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t0 = (i0 = i) && attrInterpolateNS(fullname, i);\n    return t0;\n  }\n  tween._value = value;\n  return tween;\n}\n\nfunction attrTween(name, value) {\n  var t0, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t0 = (i0 = i) && attrInterpolate(name, i);\n    return t0;\n  }\n  tween._value = value;\n  return tween;\n}\n\nexport default function(name, value) {\n  var key = \"attr.\" + name;\n  if (arguments.length < 2) return (key = this.tween(key)) && key._value;\n  if (value == null) return this.tween(key, null);\n  if (typeof value !== \"function\") throw new Error;\n  var fullname = namespace(name);\n  return this.tween(key, (fullname.local ? attrTweenNS : attrTween)(fullname, value));\n}\n","import {get, init} from \"./schedule.js\";\n\nfunction delayFunction(id, value) {\n  return function() {\n    init(this, id).delay = +value.apply(this, arguments);\n  };\n}\n\nfunction delayConstant(id, value) {\n  return value = +value, function() {\n    init(this, id).delay = value;\n  };\n}\n\nexport default function(value) {\n  var id = this._id;\n\n  return arguments.length\n      ? this.each((typeof value === \"function\"\n          ? delayFunction\n          : delayConstant)(id, value))\n      : get(this.node(), id).delay;\n}\n","import {get, set} from \"./schedule.js\";\n\nfunction durationFunction(id, value) {\n  return function() {\n    set(this, id).duration = +value.apply(this, arguments);\n  };\n}\n\nfunction durationConstant(id, value) {\n  return value = +value, function() {\n    set(this, id).duration = value;\n  };\n}\n\nexport default function(value) {\n  var id = this._id;\n\n  return arguments.length\n      ? this.each((typeof value === \"function\"\n          ? durationFunction\n          : durationConstant)(id, value))\n      : get(this.node(), id).duration;\n}\n","import {get, set} from \"./schedule.js\";\n\nfunction easeConstant(id, value) {\n  if (typeof value !== \"function\") throw new Error;\n  return function() {\n    set(this, id).ease = value;\n  };\n}\n\nexport default function(value) {\n  var id = this._id;\n\n  return arguments.length\n      ? this.each(easeConstant(id, value))\n      : get(this.node(), id).ease;\n}\n","import {get, set, init} from \"./schedule.js\";\n\nfunction start(name) {\n  return (name + \"\").trim().split(/^|\\s+/).every(function(t) {\n    var i = t.indexOf(\".\");\n    if (i >= 0) t = t.slice(0, i);\n    return !t || t === \"start\";\n  });\n}\n\nfunction onFunction(id, name, listener) {\n  var on0, on1, sit = start(name) ? init : set;\n  return function() {\n    var schedule = sit(this, id),\n        on = schedule.on;\n\n    // If this node shared a dispatch with the previous node,\n    // just assign the updated shared dispatch and were done!\n    // Otherwise, copy-on-write.\n    if (on !== on0) (on1 = (on0 = on).copy()).on(name, listener);\n\n    schedule.on = on1;\n  };\n}\n\nexport default function(name, listener) {\n  var id = this._id;\n\n  return arguments.length < 2\n      ? get(this.node(), id).on.on(name)\n      : this.each(onFunction(id, name, listener));\n}\n","import {selection} from \"d3-selection\";\n\nvar Selection = selection.prototype.constructor;\n\nexport default function() {\n  return new Selection(this._groups, this._parents);\n}\n","import {interpolateTransformCss as interpolateTransform} from \"d3-interpolate\";\nimport {style} from \"d3-selection\";\nimport {set} from \"./schedule.js\";\nimport {tweenValue} from \"./tween.js\";\nimport interpolate from \"./interpolate.js\";\n\nfunction styleNull(name, interpolate) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0 = style(this, name),\n        string1 = (this.style.removeProperty(name), style(this, name));\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, string10 = string1);\n  };\n}\n\nfunction styleRemove(name) {\n  return function() {\n    this.style.removeProperty(name);\n  };\n}\n\nfunction styleConstant(name, interpolate, value1) {\n  var string00,\n      string1 = value1 + \"\",\n      interpolate0;\n  return function() {\n    var string0 = style(this, name);\n    return string0 === string1 ? null\n        : string0 === string00 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, value1);\n  };\n}\n\nfunction styleFunction(name, interpolate, value) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0 = style(this, name),\n        value1 = value(this),\n        string1 = value1 + \"\";\n    if (value1 == null) string1 = value1 = (this.style.removeProperty(name), style(this, name));\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));\n  };\n}\n\nfunction styleMaybeRemove(id, name) {\n  var on0, on1, listener0, key = \"style.\" + name, event = \"end.\" + key, remove;\n  return function() {\n    var schedule = set(this, id),\n        on = schedule.on,\n        listener = schedule.value[key] == null ? remove || (remove = styleRemove(name)) : undefined;\n\n    // If this node shared a dispatch with the previous node,\n    // just assign the updated shared dispatch and were done!\n    // Otherwise, copy-on-write.\n    if (on !== on0 || listener0 !== listener) (on1 = (on0 = on).copy()).on(event, listener0 = listener);\n\n    schedule.on = on1;\n  };\n}\n\nexport default function(name, value, priority) {\n  var i = (name += \"\") === \"transform\" ? interpolateTransform : interpolate;\n  return value == null ? this\n      .styleTween(name, styleNull(name, i))\n      .on(\"end.style.\" + name, styleRemove(name))\n    : typeof value === \"function\" ? this\n      .styleTween(name, styleFunction(name, i, tweenValue(this, \"style.\" + name, value)))\n      .each(styleMaybeRemove(this._id, name))\n    : this\n      .styleTween(name, styleConstant(name, i, value), priority)\n      .on(\"end.style.\" + name, null);\n}\n","function styleInterpolate(name, i, priority) {\n  return function(t) {\n    this.style.setProperty(name, i.call(this, t), priority);\n  };\n}\n\nfunction styleTween(name, value, priority) {\n  var t, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t = (i0 = i) && styleInterpolate(name, i, priority);\n    return t;\n  }\n  tween._value = value;\n  return tween;\n}\n\nexport default function(name, value, priority) {\n  var key = \"style.\" + (name += \"\");\n  if (arguments.length < 2) return (key = this.tween(key)) && key._value;\n  if (value == null) return this.tween(key, null);\n  if (typeof value !== \"function\") throw new Error;\n  return this.tween(key, styleTween(name, value, priority == null ? \"\" : priority));\n}\n","function textInterpolate(i) {\n  return function(t) {\n    this.textContent = i.call(this, t);\n  };\n}\n\nfunction textTween(value) {\n  var t0, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t0 = (i0 = i) && textInterpolate(i);\n    return t0;\n  }\n  tween._value = value;\n  return tween;\n}\n\nexport default function(value) {\n  var key = \"text\";\n  if (arguments.length < 1) return (key = this.tween(key)) && key._value;\n  if (value == null) return this.tween(key, null);\n  if (typeof value !== \"function\") throw new Error;\n  return this.tween(key, textTween(value));\n}\n","import {selection} from \"d3-selection\";\nimport transition_attr from \"./attr.js\";\nimport transition_attrTween from \"./attrTween.js\";\nimport transition_delay from \"./delay.js\";\nimport transition_duration from \"./duration.js\";\nimport transition_ease from \"./ease.js\";\nimport transition_filter from \"./filter.js\";\nimport transition_merge from \"./merge.js\";\nimport transition_on from \"./on.js\";\nimport transition_remove from \"./remove.js\";\nimport transition_select from \"./select.js\";\nimport transition_selectAll from \"./selectAll.js\";\nimport transition_selection from \"./selection.js\";\nimport transition_style from \"./style.js\";\nimport transition_styleTween from \"./styleTween.js\";\nimport transition_text from \"./text.js\";\nimport transition_textTween from \"./textTween.js\";\nimport transition_transition from \"./transition.js\";\nimport transition_tween from \"./tween.js\";\nimport transition_end from \"./end.js\";\n\nvar id = 0;\n\nexport function Transition(groups, parents, name, id) {\n  this._groups = groups;\n  this._parents = parents;\n  this._name = name;\n  this._id = id;\n}\n\nexport default function transition(name) {\n  return selection().transition(name);\n}\n\nexport function newId() {\n  return ++id;\n}\n\nvar selection_prototype = selection.prototype;\n\nTransition.prototype = transition.prototype = {\n  constructor: Transition,\n  select: transition_select,\n  selectAll: transition_selectAll,\n  filter: transition_filter,\n  merge: transition_merge,\n  selection: transition_selection,\n  transition: transition_transition,\n  call: selection_prototype.call,\n  nodes: selection_prototype.nodes,\n  node: selection_prototype.node,\n  size: selection_prototype.size,\n  empty: selection_prototype.empty,\n  each: selection_prototype.each,\n  on: transition_on,\n  attr: transition_attr,\n  attrTween: transition_attrTween,\n  style: transition_style,\n  styleTween: transition_styleTween,\n  text: transition_text,\n  textTween: transition_textTween,\n  remove: transition_remove,\n  tween: transition_tween,\n  delay: transition_delay,\n  duration: transition_duration,\n  ease: transition_ease,\n  end: transition_end\n};\n","import {selector} from \"d3-selection\";\nimport {Transition} from \"./index.js\";\nimport schedule, {get} from \"./schedule.js\";\n\nexport default function(select) {\n  var name = this._name,\n      id = this._id;\n\n  if (typeof select !== \"function\") select = selector(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {\n      if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {\n        if (\"__data__\" in node) subnode.__data__ = node.__data__;\n        subgroup[i] = subnode;\n        schedule(subgroup[i], name, id, i, subgroup, get(node, id));\n      }\n    }\n  }\n\n  return new Transition(subgroups, this._parents, name, id);\n}\n","import {selectorAll} from \"d3-selection\";\nimport {Transition} from \"./index.js\";\nimport schedule, {get} from \"./schedule.js\";\n\nexport default function(select) {\n  var name = this._name,\n      id = this._id;\n\n  if (typeof select !== \"function\") select = selectorAll(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        for (var children = select.call(node, node.__data__, i, group), child, inherit = get(node, id), k = 0, l = children.length; k < l; ++k) {\n          if (child = children[k]) {\n            schedule(child, name, id, k, children, inherit);\n          }\n        }\n        subgroups.push(children);\n        parents.push(node);\n      }\n    }\n  }\n\n  return new Transition(subgroups, parents, name, id);\n}\n","import {matcher} from \"d3-selection\";\nimport {Transition} from \"./index.js\";\n\nexport default function(match) {\n  if (typeof match !== \"function\") match = matcher(match);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {\n      if ((node = group[i]) && match.call(node, node.__data__, i, group)) {\n        subgroup.push(node);\n      }\n    }\n  }\n\n  return new Transition(subgroups, this._parents, this._name, this._id);\n}\n","import {Transition} from \"./index.js\";\n\nexport default function(transition) {\n  if (transition._id !== this._id) throw new Error;\n\n  for (var groups0 = this._groups, groups1 = transition._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {\n    for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group0[i] || group1[i]) {\n        merge[i] = node;\n      }\n    }\n  }\n\n  for (; j < m0; ++j) {\n    merges[j] = groups0[j];\n  }\n\n  return new Transition(merges, this._parents, this._name, this._id);\n}\n","import {Transition, newId} from \"./index.js\";\nimport schedule, {get} from \"./schedule.js\";\n\nexport default function() {\n  var name = this._name,\n      id0 = this._id,\n      id1 = newId();\n\n  for (var groups = this._groups, m = groups.length, j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        var inherit = get(node, id0);\n        schedule(node, name, id1, i, group, {\n          time: inherit.time + inherit.delay + inherit.duration,\n          delay: 0,\n          duration: inherit.duration,\n          ease: inherit.ease\n        });\n      }\n    }\n  }\n\n  return new Transition(groups, this._parents, name, id1);\n}\n","import {tweenValue} from \"./tween.js\";\n\nfunction textConstant(value) {\n  return function() {\n    this.textContent = value;\n  };\n}\n\nfunction textFunction(value) {\n  return function() {\n    var value1 = value(this);\n    this.textContent = value1 == null ? \"\" : value1;\n  };\n}\n\nexport default function(value) {\n  return this.tween(\"text\", typeof value === \"function\"\n      ? textFunction(tweenValue(this, \"text\", value))\n      : textConstant(value == null ? \"\" : value + \"\"));\n}\n","function removeFunction(id) {\n  return function() {\n    var parent = this.parentNode;\n    for (var i in this.__transition) if (+i !== id) return;\n    if (parent) parent.removeChild(this);\n  };\n}\n\nexport default function() {\n  return this.on(\"end.remove\", removeFunction(this._id));\n}\n","import {set} from \"./schedule.js\";\n\nexport default function() {\n  var on0, on1, that = this, id = that._id, size = that.size();\n  return new Promise(function(resolve, reject) {\n    var cancel = {value: reject},\n        end = {value: function() { if (--size === 0) resolve(); }};\n\n    that.each(function() {\n      var schedule = set(this, id),\n          on = schedule.on;\n\n      // If this node shared a dispatch with the previous node,\n      // just assign the updated shared dispatch and were done!\n      // Otherwise, copy-on-write.\n      if (on !== on0) {\n        on1 = (on0 = on).copy();\n        on1._.cancel.push(cancel);\n        on1._.interrupt.push(cancel);\n        on1._.end.push(end);\n      }\n\n      schedule.on = on1;\n    });\n  });\n}\n","import {Transition, newId} from \"../transition/index.js\";\nimport schedule from \"../transition/schedule.js\";\nimport {easeCubicInOut} from \"d3-ease\";\nimport {now} from \"d3-timer\";\n\nvar defaultTiming = {\n  time: null, // Set on use.\n  delay: 0,\n  duration: 250,\n  ease: easeCubicInOut\n};\n\nfunction inherit(node, id) {\n  var timing;\n  while (!(timing = node.__transition) || !(timing = timing[id])) {\n    if (!(node = node.parentNode)) {\n      return defaultTiming.time = now(), defaultTiming;\n    }\n  }\n  return timing;\n}\n\nexport default function(name) {\n  var id,\n      timing;\n\n  if (name instanceof Transition) {\n    id = name._id, name = name._name;\n  } else {\n    id = newId(), (timing = defaultTiming).time = now(), name = name == null ? null : name + \"\";\n  }\n\n  for (var groups = this._groups, m = groups.length, j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        schedule(node, name, id, i, group, timing || inherit(node, id));\n      }\n    }\n  }\n\n  return new Transition(groups, this._parents, name, id);\n}\n","export function cubicIn(t) {\n  return t * t * t;\n}\n\nexport function cubicOut(t) {\n  return --t * t * t + 1;\n}\n\nexport function cubicInOut(t) {\n  return ((t *= 2) <= 1 ? t * t * t : (t -= 2) * t * t + 2) / 2;\n}\n","import {select, selectAll} from \"d3-selection\";\nimport {transition} from \"d3-transition\";\n\nimport {venn, lossFunction, normalizeSolution, scaleSolution} from \"./layout\";\nimport {intersectionArea, distance, getCenter} from \"./circleintersection\";\nimport {nelderMead} from \"./fmin/index.js\";\n\n/*global console:true*/\n\nexport function VennDiagram() {\n    var width = 600,\n        height = 350,\n        padding = 15,\n        duration = 1000,\n        orientation = Math.PI / 2,\n        normalize = true,\n        wrap = true,\n        styled = true,\n        fontSize = null,\n        orientationOrder = null,\n\n        // mimic the behaviour of d3.scale.category10 from the previous\n        // version of d3\n        colourMap = {},\n\n        // so this is the same as d3.schemeCategory10, which is only defined in d3 4.0\n        // since we can support older versions of d3 as long as we don't force this,\n        // I'm hackily redefining below. TODO: remove this and change to d3.schemeCategory10\n        colourScheme = [\"#1f77b4\", \"#ff7f0e\", \"#2ca02c\", \"#d62728\", \"#9467bd\", \"#8c564b\", \"#e377c2\", \"#7f7f7f\", \"#bcbd22\", \"#17becf\"],\n        colourIndex = 0,\n        colours = function(key) {\n            if (key in colourMap) {\n                return colourMap[key];\n            }\n            var ret = colourMap[key] = colourScheme[colourIndex];\n            colourIndex += 1;\n            if (colourIndex >= colourScheme.length) {\n                colourIndex = 0;\n            }\n            return ret;\n        },\n        layoutFunction = venn,\n        loss = lossFunction;\n\n\n    function chart(selection) {\n        var data = selection.datum();\n\n        // handle 0-sized sets by removing from input\n        var toremove = {};\n        data.forEach(function(datum) {\n            if ((datum.size == 0) && datum.sets.length == 1) {\n                toremove[datum.sets[0]] = 1;\n            }\n        });\n        data = data.filter(function(datum) {\n            return !datum.sets.some(function(set) { return set in toremove; });\n        });\n\n        var circles = {};\n        var textCentres = {};\n\n        if (data.length > 0) {\n            var solution = layoutFunction(data, {lossFunction: loss});\n\n            if (normalize) {\n                solution = normalizeSolution(solution,\n                                            orientation,\n                                            orientationOrder);\n            }\n\n            circles = scaleSolution(solution, width, height, padding);\n            textCentres = computeTextCentres(circles, data);\n        }\n\n        // Figure out the current label for each set. These can change\n        // and D3 won't necessarily update (fixes https://github.com/benfred/venn.js/issues/103)\n        var labels = {};\n        data.forEach(function(datum) {\n            if (datum.label) {\n                labels[datum.sets] = datum.label;\n            }\n        });\n\n        function label(d) {\n            if (d.sets in labels) {\n                return labels[d.sets];\n            }\n            if (d.sets.length == 1) {\n                return '' + d.sets[0];\n            }\n        }\n\n        // create svg if not already existing\n        selection.selectAll(\"svg\").data([circles]).enter().append(\"svg\");\n\n        var svg = selection.select(\"svg\")\n            .attr(\"width\", width)\n            .attr(\"height\", height);\n\n        // to properly transition intersection areas, we need the\n        // previous circles locations. load from elements\n        var previous = {}, hasPrevious = false;\n        svg.selectAll(\".venn-area path\").each(function (d) {\n            var path = select(this).attr(\"d\");\n            if ((d.sets.length == 1) && path) {\n                hasPrevious = true;\n                previous[d.sets[0]] = circleFromPath(path);\n            }\n        });\n\n        // interpolate intersection area paths between previous and\n        // current paths\n        var pathTween = function(d) {\n            return function(t) {\n                var c = d.sets.map(function(set) {\n                    var start = previous[set], end = circles[set];\n                    if (!start) {\n                        start = {x : width/2, y : height/2, radius : 1};\n                    }\n                    if (!end) {\n                        end = {x : width/2, y : height/2, radius : 1};\n                    }\n                    return {'x' : start.x * (1 - t) + end.x * t,\n                            'y' : start.y * (1 - t) + end.y * t,\n                            'radius' : start.radius * (1 - t) + end.radius * t};\n                });\n                return intersectionAreaPath(c);\n            };\n        };\n\n        // update data, joining on the set ids\n        var nodes = svg.selectAll(\".venn-area\")\n            .data(data, function(d) { return d.sets; });\n\n        // create new nodes\n        var enter = nodes.enter()\n            .append('g')\n            .attr(\"class\", function(d) {\n                return \"venn-area venn-\" +\n                    (d.sets.length == 1 ? \"circle\" : \"intersection\");\n            })\n            .attr(\"data-venn-sets\", function(d) {\n                return d.sets.join(\"_\");\n            });\n\n        var enterPath = enter.append(\"path\"),\n            enterText = enter.append(\"text\")\n            .attr(\"class\", \"label\")\n            .text(function (d) { return label(d); } )\n            .attr(\"text-anchor\", \"middle\")\n            .attr(\"dy\", \".35em\")\n            .attr(\"x\", width/2)\n            .attr(\"y\", height/2);\n\n\n        // apply minimal style if wanted\n        if (styled) {\n            enterPath.style(\"fill-opacity\", \"0\")\n                .filter(function (d) { return d.sets.length == 1; } )\n                .style(\"fill\", function(d) { return colours(d.sets); })\n                .style(\"fill-opacity\", \".25\");\n\n            enterText\n                .style(\"fill\", function(d) { return d.sets.length == 1 ? colours(d.sets) : \"#444\"; });\n        }\n\n        // update existing, using pathTween if necessary\n        var update = selection;\n        if (hasPrevious) {\n            update = selection.transition(\"venn\").duration(duration);\n            update.selectAll(\"path\")\n                .attrTween(\"d\", pathTween);\n        } else {\n            update.selectAll(\"path\")\n                .attr(\"d\", function(d) {\n                    return intersectionAreaPath(d.sets.map(function (set) { return circles[set]; }));\n                });\n        }\n\n        var updateText = update.selectAll(\"text\")\n            .filter(function (d) { return d.sets in textCentres; })\n            .text(function (d) { return label(d); } )\n            .attr(\"x\", function(d) { return Math.floor(textCentres[d.sets].x);})\n            .attr(\"y\", function(d) { return Math.floor(textCentres[d.sets].y);});\n\n        if (wrap) {\n            if (hasPrevious) {\n                // d3 4.0 uses 'on' for events on transitions,\n                // but d3 3.0 used 'each' instead. switch appropiately\n                if ('on' in updateText) {\n                    updateText.on(\"end\", wrapText(circles, label));\n                } else {\n                    updateText.each(\"end\", wrapText(circles, label));\n                }\n            } else {\n                updateText.each(wrapText(circles, label));\n            }\n        }\n\n        // remove old\n        var exit = nodes.exit().transition('venn').duration(duration).remove();\n        exit.selectAll(\"path\")\n            .attrTween(\"d\", pathTween);\n\n        var exitText = exit.selectAll(\"text\")\n            .attr(\"x\", width/2)\n            .attr(\"y\", height/2);\n\n        // if we've been passed a fontSize explicitly, use it to\n        // transition\n        if (fontSize !== null) {\n            enterText.style(\"font-size\", \"0px\");\n            updateText.style(\"font-size\", fontSize);\n            exitText.style(\"font-size\", \"0px\");\n        }\n\n\n        return {'circles': circles,\n                'textCentres': textCentres,\n                'nodes': nodes,\n                'enter': enter,\n                'update': update,\n                'exit': exit};\n    }\n\n    chart.wrap = function(_) {\n        if (!arguments.length) return wrap;\n        wrap = _;\n        return chart;\n    };\n\n    chart.width = function(_) {\n        if (!arguments.length) return width;\n        width = _;\n        return chart;\n    };\n\n    chart.height = function(_) {\n        if (!arguments.length) return height;\n        height = _;\n        return chart;\n    };\n\n    chart.padding = function(_) {\n        if (!arguments.length) return padding;\n        padding = _;\n        return chart;\n    };\n\n    chart.colours = function(_) {\n        if (!arguments.length) return colours;\n        colours = _;\n        return chart;\n    };\n\n    chart.fontSize = function(_) {\n        if (!arguments.length) return fontSize;\n        fontSize = _;\n        return chart;\n    };\n\n    chart.duration = function(_) {\n        if (!arguments.length) return duration;\n        duration = _;\n        return chart;\n    };\n\n    chart.layoutFunction = function(_) {\n        if (!arguments.length) return layoutFunction;\n        layoutFunction = _;\n        return chart;\n    };\n\n    chart.normalize = function(_) {\n        if (!arguments.length) return normalize;\n        normalize = _;\n        return chart;\n    };\n\n    chart.styled = function(_) {\n        if (!arguments.length) return styled;\n        styled = _;\n        return chart;\n    };\n\n    chart.orientation = function(_) {\n        if (!arguments.length) return orientation;\n        orientation = _;\n        return chart;\n    };\n\n    chart.orientationOrder = function(_) {\n        if (!arguments.length) return orientationOrder;\n        orientationOrder = _;\n        return chart;\n    };\n\n    chart.lossFunction = function(_) {\n      if (!arguments.length) return loss;\n      loss = _;\n      return chart;\n    };\n\n    return chart;\n}\n// sometimes text doesn't fit inside the circle, if thats the case lets wrap\n// the text here such that it fits\n// todo: looks like this might be merged into d3 (\n// https://github.com/mbostock/d3/issues/1642),\n// also worth checking out is\n// http://engineering.findthebest.com/wrapping-axis-labels-in-d3-js/\n// this seems to be one of those things that should be easy but isn't\nexport function wrapText(circles, labeller) {\n    return function() {\n        var text = select(this),\n            data = text.datum(),\n            width = circles[data.sets[0]].radius || 50,\n            label = labeller(data) || '';\n\n            var words = label.split(/\\s+/).reverse(),\n            maxLines = 3,\n            minChars = (label.length + words.length) / maxLines,\n            word = words.pop(),\n            line = [word],\n            joined,\n            lineNumber = 0,\n            lineHeight = 1.1, // ems\n            tspan = text.text(null).append(\"tspan\").text(word);\n\n        while (true) {\n            word = words.pop();\n            if (!word) break;\n            line.push(word);\n            joined = line.join(\" \");\n            tspan.text(joined);\n            if (joined.length > minChars && tspan.node().getComputedTextLength() > width) {\n                line.pop();\n                tspan.text(line.join(\" \"));\n                line = [word];\n                tspan = text.append(\"tspan\").text(word);\n                lineNumber++;\n            }\n        }\n\n        var initial = 0.35 - lineNumber * lineHeight / 2,\n            x = text.attr(\"x\"),\n            y = text.attr(\"y\");\n\n        text.selectAll(\"tspan\")\n            .attr(\"x\", x)\n            .attr(\"y\", y)\n            .attr(\"dy\", function(d, i) {\n                 return (initial + i * lineHeight) + \"em\";\n            });\n    };\n}\n\nfunction circleMargin(current, interior, exterior) {\n    var margin = interior[0].radius - distance(interior[0], current), i, m;\n    for (i = 1; i < interior.length; ++i) {\n        m = interior[i].radius - distance(interior[i], current);\n        if (m <= margin) {\n            margin = m;\n        }\n    }\n\n    for (i = 0; i < exterior.length; ++i) {\n        m = distance(exterior[i], current) - exterior[i].radius;\n        if (m <= margin) {\n            margin = m;\n        }\n    }\n    return margin;\n}\n\n// compute the center of some circles by maximizing the margin of\n// the center point relative to the circles (interior) after subtracting\n// nearby circles (exterior)\nexport function computeTextCentre(interior, exterior) {\n    // get an initial estimate by sampling around the interior circles\n    // and taking the point with the biggest margin\n    var points = [], i;\n    for (i = 0; i < interior.length; ++i) {\n        var c = interior[i];\n        points.push({x: c.x, y: c.y});\n        points.push({x: c.x + c.radius/2, y: c.y});\n        points.push({x: c.x - c.radius/2, y: c.y});\n        points.push({x: c.x, y: c.y + c.radius/2});\n        points.push({x: c.x, y: c.y - c.radius/2});\n    }\n    var initial = points[0], margin = circleMargin(points[0], interior, exterior);\n    for (i = 1; i < points.length; ++i) {\n        var m = circleMargin(points[i], interior, exterior);\n        if (m >= margin) {\n            initial = points[i];\n            margin = m;\n        }\n    }\n\n    // maximize the margin numerically\n    var solution = nelderMead(\n                function(p) { return -1 * circleMargin({x: p[0], y: p[1]}, interior, exterior); },\n                [initial.x, initial.y],\n                {maxIterations:500, minErrorDelta:1e-10}).x;\n    var ret = {x: solution[0], y: solution[1]};\n\n    // check solution, fallback as needed (happens if fully overlapped\n    // etc)\n    var valid = true;\n    for (i = 0; i < interior.length; ++i) {\n        if (distance(ret, interior[i]) > interior[i].radius) {\n            valid = false;\n            break;\n        }\n    }\n\n    for (i = 0; i < exterior.length; ++i) {\n        if (distance(ret, exterior[i]) < exterior[i].radius) {\n            valid = false;\n            break;\n        }\n    }\n\n    if (!valid) {\n        if (interior.length == 1) {\n            ret = {x: interior[0].x, y: interior[0].y};\n        } else {\n            var areaStats = {};\n            intersectionArea(interior, areaStats);\n\n            if (areaStats.arcs.length === 0) {\n                ret = {'x': 0, 'y': -1000, disjoint:true};\n\n            } else if (areaStats.arcs.length == 1) {\n                ret = {'x': areaStats.arcs[0].circle.x,\n                       'y': areaStats.arcs[0].circle.y};\n\n            } else if (exterior.length) {\n                // try again without other circles\n                ret = computeTextCentre(interior, []);\n\n            } else {\n                // take average of all the points in the intersection\n                // polygon. this should basically never happen\n                // and has some issues:\n                // https://github.com/benfred/venn.js/issues/48#issuecomment-146069777\n                ret = getCenter(areaStats.arcs.map(function (a) { return a.p1; }));\n            }\n        }\n    }\n\n    return ret;\n}\n\n// given a dictionary of {setid : circle}, returns\n// a dictionary of setid to list of circles that completely overlap it\nfunction getOverlappingCircles(circles) {\n    var ret = {}, circleids = [];\n    for (var circleid in circles) {\n        circleids.push(circleid);\n        ret[circleid] = [];\n    }\n    for (var i  = 0; i < circleids.length; i++) {\n        var a = circles[circleids[i]];\n        for (var j = i + 1; j < circleids.length; ++j) {\n            var b = circles[circleids[j]],\n                d = distance(a, b);\n\n            if (d + b.radius <= a.radius + 1e-10) {\n                ret[circleids[j]].push(circleids[i]);\n\n            } else if (d + a.radius <= b.radius + 1e-10) {\n                ret[circleids[i]].push(circleids[j]);\n            }\n        }\n    }\n    return ret;\n}\n\nexport function computeTextCentres(circles, areas) {\n    var ret = {}, overlapped = getOverlappingCircles(circles);\n    for (var i = 0; i < areas.length; ++i) {\n        var area = areas[i].sets, areaids = {}, exclude = {};\n        for (var j = 0; j < area.length; ++j) {\n            areaids[area[j]] = true;\n            var overlaps = overlapped[area[j]];\n            // keep track of any circles that overlap this area,\n            // and don't consider for purposes of computing the text\n            // centre\n            for (var k = 0; k < overlaps.length; ++k) {\n                exclude[overlaps[k]] = true;\n            }\n        }\n\n        var interior = [], exterior = [];\n        for (var setid in circles) {\n            if (setid in areaids) {\n                interior.push(circles[setid]);\n            } else if (!(setid in exclude)) {\n                exterior.push(circles[setid]);\n            }\n        }\n        var centre = computeTextCentre(interior, exterior);\n        ret[area] = centre;\n        if (centre.disjoint && (areas[i].size > 0)) {\n            console.log(\"WARNING: area \" + area + \" not represented on screen\");\n        }\n    }\n    return  ret;\n}\n\n// sorts all areas in the venn diagram, so that\n// a particular area is on top (relativeTo) - and\n// all other areas are so that the smallest areas are on top\nexport function sortAreas(div, relativeTo) {\n\n    // figure out sets that are completly overlapped by relativeTo\n    var overlaps = getOverlappingCircles(div.selectAll(\"svg\").datum());\n    var exclude = {};\n    for (var i = 0; i < relativeTo.sets.length; ++i) {\n        var check = relativeTo.sets[i];\n        for (var setid in overlaps) {\n            var overlap = overlaps[setid];\n            for (var j = 0; j < overlap.length; ++j) {\n                if (overlap[j] == check) {\n                    exclude[setid] = true;\n                    break;\n                }\n            }\n        }\n    }\n\n    // checks that all sets are in exclude;\n    function shouldExclude(sets) {\n        for (var i = 0; i < sets.length; ++i) {\n            if (!(sets[i] in exclude)) {\n                return false;\n            }\n        }\n        return true;\n    }\n\n    // need to sort div's so that Z order is correct\n    div.selectAll(\"g\").sort(function (a, b) {\n        // highest order set intersections first\n        if (a.sets.length != b.sets.length) {\n            return a.sets.length - b.sets.length;\n        }\n\n        if (a == relativeTo) {\n            return shouldExclude(b.sets) ? -1 : 1;\n        }\n        if (b == relativeTo) {\n            return shouldExclude(a.sets) ? 1 : -1;\n        }\n\n        // finally by size\n        return b.size - a.size;\n    });\n}\n\nexport function circlePath(x, y, r) {\n    var ret = [];\n    ret.push(\"\\nM\", x, y);\n    ret.push(\"\\nm\", -r, 0);\n    ret.push(\"\\na\", r, r, 0, 1, 0, r *2, 0);\n    ret.push(\"\\na\", r, r, 0, 1, 0,-r *2, 0);\n    return ret.join(\" \");\n}\n\n// inverse of the circlePath function, returns a circle object from an svg path\nexport function circleFromPath(path) {\n    var tokens = path.split(' ');\n    return {'x' : parseFloat(tokens[1]),\n            'y' : parseFloat(tokens[2]),\n            'radius' : -parseFloat(tokens[4])\n            };\n}\n\n/** returns a svg path of the intersection area of a bunch of circles */\nexport function intersectionAreaPath(circles) {\n    var stats = {};\n    intersectionArea(circles, stats);\n    var arcs = stats.arcs;\n\n    if (arcs.length === 0) {\n        return \"M 0 0\";\n\n    } else if (arcs.length == 1) {\n        var circle = arcs[0].circle;\n        return circlePath(circle.x, circle.y, circle.radius);\n\n    } else {\n        // draw path around arcs\n        var ret = [\"\\nM\", arcs[0].p2.x, arcs[0].p2.y];\n        for (var i = 0; i < arcs.length; ++i) {\n            var arc = arcs[i], r = arc.circle.radius, wide = arc.width > r;\n            ret.push(\"\\nA\", r, r, 0, wide ? 1 : 0, 1,\n                     arc.p1.x, arc.p1.y);\n        }\n        return ret.join(\" \");\n    }\n}\n","import {selection} from \"d3-selection\";\nimport selection_interrupt from \"./interrupt.js\";\nimport selection_transition from \"./transition.js\";\n\nselection.prototype.interrupt = selection_interrupt;\nselection.prototype.transition = selection_transition;\n","import interrupt from \"../interrupt.js\";\n\nexport default function(name) {\n  return this.each(function() {\n    interrupt(this, name);\n  });\n}\n","import {STARTING, ENDING, ENDED} from \"./transition/schedule.js\";\n\nexport default function(node, name) {\n  var schedules = node.__transition,\n      schedule,\n      active,\n      empty = true,\n      i;\n\n  if (!schedules) return;\n\n  name = name == null ? null : name + \"\";\n\n  for (i in schedules) {\n    if ((schedule = schedules[i]).name !== name) { empty = false; continue; }\n    active = schedule.state > STARTING && schedule.state < ENDING;\n    schedule.state = ENDED;\n    schedule.timer.stop();\n    schedule.on.call(active ? \"interrupt\" : \"cancel\", node, node.__data__, schedule.index, schedule.group);\n    delete schedules[i];\n  }\n\n  if (empty) delete node.__transition;\n}\n","import type { DataItem } from \"../../core/render/Component\";\n\nimport { VennDefaultTheme } from \"./VennDefaultTheme\";\nimport { Series, ISeriesSettings, ISeriesDataItem, ISeriesPrivate } from \"../../core/render/Series\";\nimport { Template } from \"../../core/util/Template\";\nimport { Graphics, visualSettings } from \"../../core/render/Graphics\";\nimport { Container } from \"../../core/render/Container\";\nimport { Label } from \"../../core/render/Label\";\nimport { ListTemplate } from \"../../core/util/List\";\nimport type { ILegendDataItem } from \"../../core/render/Legend\";\nimport type { Color } from \"../../core/util/Color\";\nimport type { ColorSet } from \"../../core/util/ColorSet\";\n\nimport * as $utils from \"../../core/util/Utils\";\nimport * as $array from \"../../core/util/Array\";\nimport * as $type from \"../../core/util/Type\";\nimport * as venn from \"./vennjs/index.js\";\n\nexport interface IVennDataItem extends ISeriesDataItem {\n\n\t/**\n\t * Array of categories that this data item is an intersection for.\n\t */\n\tintersections: Array<string>;\n\n\t/**\n\t * Category.\n\t */\n\tcategory: string;\n\n\t/**\n\t * Slice visaul element.\n\t */\n\tslice: Graphics;\n\n\t/**\n\t * Slice label.\n\t */\n\tlabel: Label;\n\n\t/**\n\t * A related legend data item.\n\t */\n\tlegendDataItem: DataItem<ILegendDataItem>;\n\n\t/**\n\t * Fill color used for the slice and related elements, e.g. legend marker.\n\t */\n\tfill: Color;\n\n}\n\nexport interface IVennSettings extends ISeriesSettings {\n\n\t/**\n\t * A field in data that holds array of categories that overlap.\n\t */\n\tintersectionsField?: string;\n\n\t/**\n\t * A [[ColorSet]] to use when asigning colors for slices.\n\t */\n\tcolors?: ColorSet;\n\n\t/**\n\t * A field in data that holds category names.\n\t */\n\tcategoryField?: string;\n\n\t/**\n\t * A field that holds color for slice fill.\n\t */\n\tfillField?: string;\n\n}\n\nexport interface IVennPrivate extends ISeriesPrivate {\n}\n\n/**\n * Creates a Venn diagram.\n *\n * @see {@link https://www.amcharts.com/docs/v5/charts/venn/} for more info\n * @important\n */\nexport class Venn extends Series {\n\n\tpublic static className: string = \"Venn\";\n\tpublic static classNames: Array<string> = Series.classNames.concat([Venn.className]);\n\n\tdeclare public _settings: IVennSettings;\n\tdeclare public _privateSettings: IVennPrivate;\n\tdeclare public _dataItemSettings: IVennDataItem;\n\n\tprotected _sets: string = \"\";\n\n\t/**\n\t * A [[Container]] that holds all slices (circles and intersections).\n\t *\n\t * @default Container.new()\n\t */\n\tpublic readonly slicesContainer = this.children.push(Container.new(this._root, {}));\n\n\t/**\n\t * A [[Container]] that holds all labels.\n\t *\n\t * @default Container.new()\n\t */\n\tpublic readonly labelsContainer = this.children.push(Container.new(this._root, {}));\n\n\t/**\n\t * A [[Graphics]] element that is used to show the shape of the hovered slice\n\t * or intersection.\n\t *\n\t * @default Graphics.new()\n\t */\n\tpublic readonly hoverGraphics = this.slicesContainer.children.push(Graphics.new(this._root, { position: \"absolute\", isMeasured: false }))\n\n\tprotected _hovered?: Graphics;\n\n\tprotected _afterNew() {\n\t\tthis._defaultThemes.push(VennDefaultTheme.new(this._root));\n\t\tthis.fields.push(\"intersections\", \"category\", \"fill\");\n\t\tsuper._afterNew();\n\t}\n\n\n\t/**\n\t * A [[ListTemplate]] of all slices in series.\n\t *\n\t * `slices.template` can also be used to configure slices.\n\t */\n\tpublic readonly slices: ListTemplate<Graphics> = this._makeSlices();\n\n\n\t/**\n\t * @ignore\n\t */\n\tpublic makeSlice(dataItem: DataItem<this[\"_dataItemSettings\"]>): Graphics {\n\t\tconst slice = this.slicesContainer.children.push(this.slices.make());\n\t\tslice.events.on(\"pointerover\", (e) => {\n\t\t\tthis._hovered = e.target;\n\t\t\tthis._updateHover();\n\t\t})\n\n\t\tslice.events.on(\"pointerout\", () => {\n\t\t\tthis._hovered = undefined;\n\t\t\tthis.hoverGraphics.hide();\n\t\t})\n\n\t\tslice.on(\"fill\", () => {\n\t\t\tthis.updateLegendMarker(dataItem);\n\t\t})\n\n\t\tslice.on(\"stroke\", () => {\n\t\t\tthis.updateLegendMarker(dataItem);\n\t\t})\n\n\t\tslice._setDataItem(dataItem);\n\t\tdataItem.set(\"slice\", slice);\n\t\tthis.slices.push(slice);\n\n\t\treturn slice;\n\t}\n\n\tprotected _updateHover() {\n\t\tif (this._hovered) {\n\t\t\tconst hoverGraphics = this.hoverGraphics;\n\t\t\thoverGraphics.set(\"svgPath\", this._hovered.get(\"svgPath\"));\n\t\t\thoverGraphics.show();\n\t\t\thoverGraphics.toFront();\n\t\t}\n\t}\n\n\t/**\n\t * A [[ListTemplate]] of all slice labels in series.\n\t *\n\t * `labels.template` can also be used to configure slice labels.\n\t */\n\tpublic readonly labels: ListTemplate<Label> = this._makeLabels();\n\n\t/**\n\t * @ignore\n\t */\n\tpublic makeLabel(dataItem: DataItem<this[\"_dataItemSettings\"]>): Label {\n\t\tconst label = this.labelsContainer.children.push(this.labels.make());\n\t\tlabel._setDataItem(dataItem);\n\t\tdataItem.set(\"label\", label);\n\t\tthis.labels.push(label);\n\t\treturn label;\n\t}\n\n\n\tprotected _makeSlices(): ListTemplate<Graphics> {\n\t\treturn new ListTemplate(\n\t\t\tTemplate.new({}),\n\t\t\t() => Graphics._new(this._root, {\n\t\t\t\tthemeTags: $utils.mergeTags(this.slices.template.get(\"themeTags\", []), [\"venn\", \"series\"])\n\t\t\t}, [this.slices.template]),\n\t\t);\n\t}\n\n\tprotected _makeLabels(): ListTemplate<Label> {\n\t\treturn new ListTemplate(\n\t\t\tTemplate.new({}),\n\t\t\t() => Label._new(this._root, {\n\t\t\t\tthemeTags: $utils.mergeTags(this.labels.template.get(\"themeTags\", []), [\"venn\", \"series\"])\n\t\t\t}, [this.labels.template]),\n\t\t);\n\t}\n\n\n\tprotected processDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>) {\n\t\tsuper.processDataItem(dataItem);\n\n\n\t\tif (dataItem.get(\"fill\") == null) {\n\t\t\tlet colors = this.get(\"colors\");\n\t\t\tif (colors) {\n\t\t\t\tdataItem.setRaw(\"fill\", colors.next());\n\t\t\t}\n\t\t}\n\n\t\tthis.makeSlice(dataItem);\n\t\tthis.makeLabel(dataItem);\n\t}\n\n\tpublic _prepareChildren() {\n\t\tsuper._prepareChildren();\n\n\t\tif (this._valuesDirty || this._sizeDirty) {\n\t\t\tconst sets: any[] = [];\n\n\t\t\t// prepare data for venn\n\t\t\t$array.each(this.dataItems, (dataItem) => {\n\t\t\t\tconst set: any = {};\n\t\t\t\tconst intersections = dataItem.get(\"intersections\");\n\t\t\t\tif (intersections) {\n\t\t\t\t\tset.sets = intersections;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tset.sets = [dataItem.get(\"category\")];\n\t\t\t\t}\n\t\t\t\tset.size = dataItem.get(\"valueWorking\");\n\n\t\t\t\tif (set.size > 0) {\n\t\t\t\t\tsets.push(set);\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tconst newSets = sets.toString();\n\n\t\t\tthis._sets = newSets;\n\n\t\t\tif (sets.length > 0) {\n\t\t\t\tlet vennData = venn.venn(sets);\n\t\t\t\tvennData = venn.normalizeSolution(vennData, null, null);\n\t\t\t\tvennData = venn.scaleSolution(vennData, this.innerWidth(), this.innerHeight(), 0);\n\n\t\t\t\tconst circles: any = {};\n\t\t\t\tfor (let name in vennData) {\n\t\t\t\t\tlet item = vennData[name];\n\t\t\t\t\tlet r = item.radius;\n\n\t\t\t\t\tconst dataItem = this.getDataItemByCategory(name);\n\t\t\t\t\tif (dataItem) {\n\t\t\t\t\t\tconst slice = dataItem.get(\"slice\");\n\t\t\t\t\t\tconst color = dataItem.get(\"fill\");\n\t\t\t\t\t\tslice._setDefault(\"fill\", color);\n\t\t\t\t\t\tslice._setDefault(\"stroke\", color);\n\n\t\t\t\t\t\tthis.updateLegendMarker(dataItem);\n\n\t\t\t\t\t\tslice.set(\"svgPath\", \"M\" + item.x + \",\" + item.y + \" m -\" + r + \", 0 a \" + r + \",\" + r + \" 0 1,1 \" + r * 2 + \",0 a \" + r + \",\" + r + \" 0 1,1 -\" + r * 2 + \",0\");\n\t\t\t\t\t\tcircles[name] = item;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\n\t\t\t\tlet centers: any = venn.computeTextCentres(circles, sets);\n\n\n\t\t\t\t$array.each(this.dataItems, (dataItem) => {\n\t\t\t\t\tlet name = dataItem.get(\"category\");\n\t\t\t\t\tlet center = centers[name];\n\t\t\t\t\tconst intersections = dataItem.get(\"intersections\");\n\t\t\t\t\tif (intersections) {\n\t\t\t\t\t\tname = intersections.toString();\n\t\t\t\t\t\tcenter = centers[name];\n\t\t\t\t\t\tif (center) {\n\t\t\t\t\t\t\tlet set = intersections;\n\t\t\t\t\t\t\tlet cc = [];\n\n\t\t\t\t\t\t\tfor (let s = 0; s < set.length; s++) {\n\t\t\t\t\t\t\t\tcc.push(circles[set[s]]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlet intersectionPath = venn.intersectionAreaPath(cc)\n\t\t\t\t\t\t\tlet slice = dataItem.get(\"slice\");\n\n\t\t\t\t\t\t\tconst color = dataItem.get(\"fill\");\n\t\t\t\t\t\t\tslice._setDefault(\"fill\", color);\n\t\t\t\t\t\t\tslice._setDefault(\"stroke\", color);\n\n\t\t\t\t\t\t\tslice.setAll({ svgPath: intersectionPath });\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (center) {\n\t\t\t\t\t\tlet label = dataItem.get(\"label\");\n\t\t\t\t\t\tlabel.setAll({ x: center.x, y: center.y });\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.updateLegendValue(dataItem);\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tthis._updateHover();\n\t\t}\n\t}\n\n\t/**\n\t * Looks up and returns a data item by its category.\n\t *\n\t * @param   category  Category\n\t * @return      Data item\n\t */\n\tpublic getDataItemByCategory(id: string): DataItem<this[\"_dataItemSettings\"]> | undefined {\n\t\treturn $array.find(this.dataItems, (dataItem: any) => {\n\t\t\treturn dataItem.get(\"category\") == id;\n\t\t})\n\t}\n\n\n\t/**\n\t * Shows series's data item.\n\t *\n\t * @param   dataItem  Data item\n\t * @param   duration  Animation duration in milliseconds\n\t * @return            Promise\n\t */\n\tpublic async showDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>, duration?: number): Promise<void> {\n\t\tconst promises = [super.showDataItem(dataItem, duration)];\n\t\tif (!$type.isNumber(duration)) {\n\t\t\tduration = this.get(\"stateAnimationDuration\", 0);\n\t\t}\n\n\t\tconst easing = this.get(\"stateAnimationEasing\");\n\n\t\tlet value = dataItem.get(\"value\");\n\n\t\tconst animation = dataItem.animate({ key: \"valueWorking\", to: value, duration: duration, easing: easing });\n\t\tif (animation) {\n\t\t\tpromises.push(animation.waitForStop());\n\t\t}\n\n\t\tconst label = dataItem.get(\"label\");\n\t\tif (label) {\n\t\t\tpromises.push(label.show(duration));\n\t\t}\n\n\t\tconst slice = dataItem.get(\"slice\");\n\t\tif (slice) {\n\t\t\tpromises.push(slice.show(duration));\n\t\t}\n\n\n\t\tconst intersections = dataItem.get(\"intersections\");\n\t\tif (intersections) {\n\t\t\t$array.each(intersections, (cat) => {\n\t\t\t\tconst di = this.getDataItemByCategory(cat);\n\t\t\t\tif (di && di.isHidden()) {\n\t\t\t\t\tthis.showDataItem(di, duration);\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\tif (!intersections) {\n\t\t\tconst category = dataItem.get(\"category\");\n\n\t\t\t$array.each(this.dataItems, (di) => {\n\t\t\t\tconst intersections = di.get(\"intersections\");\n\t\t\t\tif (di != dataItem && intersections) {\n\t\t\t\t\tlet allVisible = true;\n\t\t\t\t\t$array.each(intersections, (cat) => {\n\t\t\t\t\t\tconst dii = this.getDataItemByCategory(cat);\n\t\t\t\t\t\tif (dii && dii.isHidden()) {\n\t\t\t\t\t\t\tallVisible = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\n\t\t\t\t\tif (allVisible && intersections.indexOf(category) != -1) {\n\t\t\t\t\t\tif (di.isHidden()) {\n\t\t\t\t\t\t\tthis.showDataItem(di, duration);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\tawait Promise.all(promises);\n\t}\n\n\t/**\n\t * Hides series's data item.\n\t *\n\t * @param   dataItem  Data item\n\t * @param   duration  Animation duration in milliseconds\n\t * @return            Promise\n\t */\n\tpublic async hideDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>, duration?: number): Promise<void> {\n\t\tconst promises = [super.hideDataItem(dataItem, duration)];\n\t\tconst hiddenState = this.states.create(\"hidden\", {})\n\n\t\tif (!$type.isNumber(duration)) {\n\t\t\tduration = hiddenState.get(\"stateAnimationDuration\", this.get(\"stateAnimationDuration\", 0));\n\t\t}\n\n\t\tconst easing = hiddenState.get(\"stateAnimationEasing\", this.get(\"stateAnimationEasing\"));\n\n\t\tconst animation = dataItem.animate({ key: \"valueWorking\", to: 0, duration: duration, easing: easing });\n\t\tif (animation) {\n\t\t\tpromises.push(animation.waitForStop());\n\t\t}\n\n\t\tconst label = dataItem.get(\"label\");\n\t\tif (label) {\n\t\t\tpromises.push(label.hide(duration));\n\t\t}\n\n\t\tconst slice = dataItem.get(\"slice\");\n\t\tif (slice) {\n\t\t\tpromises.push(slice.hide(duration));\n\t\t}\n\n\t\tif (!dataItem.get(\"intersections\")) {\n\t\t\t$array.each(this.dataItems, (di) => {\n\t\t\t\tconst intersections = di.get(\"intersections\");\n\t\t\t\tif (di != dataItem && intersections) {\n\t\t\t\t\tif (intersections.indexOf(dataItem.get(\"category\")) != -1) {\n\t\t\t\t\t\tthis.hideDataItem(di, duration);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\tawait Promise.all(promises);\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic disposeDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>) {\n\t\tsuper.disposeDataItem(dataItem);\n\t\tlet label = dataItem.get(\"label\");\n\t\tif (label) {\n\t\t\tthis.labels.removeValue(label);\n\t\t\tlabel.dispose();\n\t\t}\n\n\t\tlet slice = dataItem.get(\"slice\");\n\t\tif (slice) {\n\t\t\tthis.slices.removeValue(slice);\n\t\t\tslice.dispose();\n\t\t}\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic updateLegendMarker(dataItem: DataItem<this[\"_dataItemSettings\"]>) {\n\t\tconst slice = dataItem.get(\"slice\");\n\n\t\tif (slice) {\n\t\t\tconst legendDataItem = dataItem.get(\"legendDataItem\");\n\t\t\tif (legendDataItem) {\n\t\t\t\tconst markerRectangle = legendDataItem.get(\"markerRectangle\");\n\n\t\t\t\t$array.each(visualSettings, (setting: any) => {\n\t\t\t\t\tmarkerRectangle.set(setting, slice.get(setting));\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Triggers hover on a series data item.\n\t *\n\t * @since 5.0.7\n\t * @param  dataItem  Target data item\n\t */\n\tpublic hoverDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>) {\n\t\tconst slice = dataItem.get(\"slice\");\n\t\tif (slice) {\n\t\t\tslice.hover();\n\t\t}\n\t}\n\n\t/**\n\t * Triggers un-hover on a series data item.\n\t *\n\t * @since 5.0.7\n\t * @param  dataItem  Target data item\n\t */\n\tpublic unhoverDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>) {\n\t\tconst slice = dataItem.get(\"slice\");\n\t\tif (slice) {\n\t\t\tslice.unhover();\n\t\t}\n\t}\n}\n","import * as m from \"./../../dist/es2015/venn.js\";\nexport const am5venn = m;"],"sourceRoot":""}